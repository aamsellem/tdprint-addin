(()=>{"use strict";var e={56(e,n,a){e.exports=function(e){var n=a.nc;n&&e.setAttribute("nonce",n)}},72(e){var n=[];function a(e){for(var a=-1,r=0;r<n.length;r++)if(n[r].identifier===e){a=r;break}return a}function r(e,r){for(var o={},i=[],l=0;l<e.length;l++){var s=e[l],c=r.base?s[0]+r.base:s[0],d=o[c]||0,p="".concat(c," ").concat(d);o[c]=d+1;var u=a(p),m={css:s[1],media:s[2],sourceMap:s[3],supports:s[4],layer:s[5]};if(-1!==u)n[u].references++,n[u].updater(m);else{var _=t(m,r);r.byIndex=l,n.splice(l,0,{identifier:p,updater:_,references:1})}i.push(p)}return i}function t(e,n){var a=n.domAPI(n);return a.update(e),function(n){if(n){if(n.css===e.css&&n.media===e.media&&n.sourceMap===e.sourceMap&&n.supports===e.supports&&n.layer===e.layer)return;a.update(e=n)}else a.remove()}}e.exports=function(e,t){var o=r(e=e||[],t=t||{});return function(e){e=e||[];for(var i=0;i<o.length;i++){var l=a(o[i]);n[l].references--}for(var s=r(e,t),c=0;c<o.length;c++){var d=a(o[c]);0===n[d].references&&(n[d].updater(),n.splice(d,1))}o=s}}},113(e){e.exports=function(e,n){if(n.styleSheet)n.styleSheet.cssText=e;else{for(;n.firstChild;)n.removeChild(n.firstChild);n.appendChild(document.createTextNode(e))}}},314(e){e.exports=function(e){var n=[];return n.toString=function(){return this.map(function(n){var a="",r=void 0!==n[5];return n[4]&&(a+="@supports (".concat(n[4],") {")),n[2]&&(a+="@media ".concat(n[2]," {")),r&&(a+="@layer".concat(n[5].length>0?" ".concat(n[5]):""," {")),a+=e(n),r&&(a+="}"),n[2]&&(a+="}"),n[4]&&(a+="}"),a}).join("")},n.i=function(e,a,r,t,o){"string"==typeof e&&(e=[[null,e,void 0]]);var i={};if(r)for(var l=0;l<this.length;l++){var s=this[l][0];null!=s&&(i[s]=!0)}for(var c=0;c<e.length;c++){var d=[].concat(e[c]);r&&i[d[0]]||(void 0!==o&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=o),a&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=a):d[2]=a),t&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=t):d[4]="".concat(t)),n.push(d))}},n}},540(e){e.exports=function(e){var n=document.createElement("style");return e.setAttributes(n,e.attributes),e.insert(n,e.options),n}},601(e){e.exports=function(e){return e[1]}},659(e){var n={};e.exports=function(e,a){var r=function(e){if(void 0===n[e]){var a=document.querySelector(e);if(window.HTMLIFrameElement&&a instanceof window.HTMLIFrameElement)try{a=a.contentDocument.head}catch(e){a=null}n[e]=a}return n[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(a)}},825(e){e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var n=e.insertStyleElement(e);return{update:function(a){!function(e,n,a){var r="";a.supports&&(r+="@supports (".concat(a.supports,") {")),a.media&&(r+="@media ".concat(a.media," {"));var t=void 0!==a.layer;t&&(r+="@layer".concat(a.layer.length>0?" ".concat(a.layer):""," {")),r+=a.css,t&&(r+="}"),a.media&&(r+="}"),a.supports&&(r+="}");var o=a.sourceMap;o&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),n.styleTagTransform(r,e,n.options)}(n,e,a)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)}}}},942(e,n,a){a.d(n,{A:()=>l});var r=a(601),t=a.n(r),o=a(314),i=a.n(o)()(t());i.push([e.id,'/* Variables CSS - Fluent UI Design */\n:root {\n  --color-primary: #0078d4;\n  --color-primary-dark: #106ebe;\n  --color-success: #107c10;\n  --color-warning: #d83b01;\n  --color-purple: #8764b8;\n  --color-text: #323130;\n  --color-text-secondary: #605e5c;\n  --color-background: #ffffff;\n  --color-background-hover: #f3f2f1;\n  --color-background-active: #edebe9;\n  --color-border: #e1dfdd;\n  --color-favorite: #ffb900;\n  --shadow-sm: 0 1.6px 3.6px 0 rgba(0, 0, 0, 0.132), 0 0.3px 0.9px 0 rgba(0, 0, 0, 0.108);\n  --shadow-md: 0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132), 0 0.6px 1.8px 0 rgba(0, 0, 0, 0.108);\n  --radius-sm: 4px;\n  --radius-md: 8px;\n  --font-family: "Segoe UI", -apple-system, BlinkMacSystemFont, sans-serif;\n}\n\n/* Reset */\n*, *::before, *::after {\n  box-sizing: border-box;\n  margin: 0;\n  padding: 0;\n}\n\n/* Base */\nhtml, body {\n  height: 100%;\n  font-family: var(--font-family);\n  font-size: 14px;\n  color: var(--color-text);\n  background-color: var(--color-background);\n  overflow: hidden;\n}\n\n#app {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n}\n\n/* Header */\n.header {\n  padding: 16px;\n  background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-primary-dark) 100%);\n  color: white;\n  flex-shrink: 0;\n}\n\n.header-title {\n  display: flex;\n  align-items: center;\n  gap: 10px;\n  margin-bottom: 12px;\n}\n\n.header-logo {\n  width: 28px;\n  height: 28px;\n}\n\n.header-title h1 {\n  font-size: 18px;\n  font-weight: 600;\n}\n\n/* Search */\n.search-container {\n  position: relative;\n}\n\n.search-input {\n  width: 100%;\n  padding: 10px 36px 10px 12px;\n  border: none;\n  border-radius: var(--radius-sm);\n  font-size: 14px;\n  font-family: var(--font-family);\n  outline: none;\n  transition: box-shadow 0.2s;\n}\n\n.search-input:focus {\n  box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.4);\n}\n\n.search-input::placeholder {\n  color: var(--color-text-secondary);\n}\n\n.clear-search {\n  position: absolute;\n  right: 8px;\n  top: 50%;\n  transform: translateY(-50%);\n  background: none;\n  border: none;\n  padding: 6px;\n  cursor: pointer;\n  color: var(--color-text-secondary);\n  border-radius: var(--radius-sm);\n  display: none;\n  transition: background-color 0.2s;\n}\n\n.clear-search:hover {\n  background-color: var(--color-background-hover);\n}\n\n.clear-search.visible {\n  display: flex;\n}\n\n/* Main Content */\n.main-content {\n  flex: 1;\n  overflow-y: auto;\n  padding: 8px;\n}\n\n/* Favorites Section */\n.favorites-section {\n  margin-bottom: 8px;\n  background-color: #fffef5;\n  border: 1px solid #fff3cd;\n  border-radius: var(--radius-md);\n  overflow: hidden;\n}\n\n.favorites-section.hidden {\n  display: none;\n}\n\n.favorites-header {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 12px;\n  background-color: #fff8e1;\n  color: #8a6d3b;\n  font-weight: 600;\n}\n\n.favorites-header .section-icon {\n  color: var(--color-favorite);\n}\n\n/* Category Accordion */\n.category {\n  margin-bottom: 4px;\n  border: 1px solid var(--color-border);\n  border-radius: var(--radius-md);\n  overflow: hidden;\n}\n\n.category-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 12px;\n  background-color: var(--color-background);\n  cursor: pointer;\n  user-select: none;\n  transition: background-color 0.2s;\n}\n\n.category-header:hover {\n  background-color: var(--color-background-hover);\n}\n\n.category-header-left {\n  display: flex;\n  align-items: center;\n  gap: 10px;\n}\n\n.category-icon {\n  width: 20px;\n  height: 20px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: transform 0.2s;\n}\n\n.category.expanded .category-icon {\n  transform: rotate(90deg);\n}\n\n.category-name {\n  font-weight: 600;\n  font-size: 14px;\n}\n\n.badge-count {\n  background-color: var(--color-primary);\n  color: white;\n  padding: 2px 8px;\n  border-radius: 12px;\n  font-size: 12px;\n  font-weight: 500;\n}\n\n.category-content {\n  display: none;\n  border-top: 1px solid var(--color-border);\n}\n\n.category.expanded .category-content {\n  display: block;\n}\n\n/* Variables List */\n.variables-list {\n  padding: 8px;\n}\n\n/* Variable Item */\n.variable-item {\n  display: flex;\n  align-items: flex-start;\n  gap: 10px;\n  padding: 10px;\n  margin-bottom: 4px;\n  background-color: var(--color-background);\n  border: 1px solid var(--color-border);\n  border-radius: var(--radius-sm);\n  cursor: grab;\n  transition: all 0.2s;\n}\n\n.variable-item:hover {\n  background-color: var(--color-background-hover);\n  border-color: var(--color-primary);\n  box-shadow: var(--shadow-sm);\n}\n\n.variable-item:active {\n  cursor: grabbing;\n}\n\n.variable-item.dragging {\n  opacity: 0.5;\n  transform: scale(0.98);\n}\n\n.variable-main {\n  flex: 1;\n  min-width: 0;\n}\n\n.variable-header {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  margin-bottom: 4px;\n}\n\n.variable-placeholder {\n  font-family: "Consolas", "Monaco", monospace;\n  font-size: 13px;\n  color: var(--color-primary);\n  font-weight: 500;\n  word-break: break-all;\n}\n\n.variable-type {\n  padding: 2px 6px;\n  border-radius: 3px;\n  font-size: 10px;\n  font-weight: 600;\n  color: white;\n  flex-shrink: 0;\n}\n\n.variable-type.type-C {\n  background-color: var(--color-primary);\n}\n\n.variable-type.type-B {\n  background-color: var(--color-success);\n}\n\n.variable-type.type-I {\n  background-color: var(--color-purple);\n}\n\n.variable-type.type-T {\n  background-color: var(--color-warning);\n}\n\n.variable-description {\n  font-size: 12px;\n  color: var(--color-text-secondary);\n  line-height: 1.4;\n}\n\n.variable-category {\n  font-size: 11px;\n  color: var(--color-text-secondary);\n  margin-top: 4px;\n  font-style: italic;\n}\n\n/* Favorite Button */\n.favorite-btn {\n  background: none;\n  border: none;\n  padding: 4px;\n  cursor: pointer;\n  color: var(--color-border);\n  border-radius: var(--radius-sm);\n  transition: all 0.2s;\n  flex-shrink: 0;\n}\n\n.favorite-btn:hover {\n  color: var(--color-favorite);\n  transform: scale(1.1);\n}\n\n.favorite-btn.active {\n  color: var(--color-favorite);\n}\n\n.favorite-btn svg {\n  width: 18px;\n  height: 18px;\n}\n\n/* Insert Button */\n.insert-btn {\n  background-color: var(--color-primary);\n  color: white;\n  border: none;\n  padding: 6px 10px;\n  border-radius: var(--radius-sm);\n  font-size: 12px;\n  font-weight: 500;\n  cursor: pointer;\n  transition: background-color 0.2s;\n  flex-shrink: 0;\n}\n\n.insert-btn:hover {\n  background-color: var(--color-primary-dark);\n}\n\n/* No Results */\n.no-results {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  padding: 40px 20px;\n  text-align: center;\n}\n\n.no-results.hidden {\n  display: none;\n}\n\n.no-results p {\n  margin-top: 16px;\n  color: var(--color-text-secondary);\n  font-size: 14px;\n}\n\n/* Footer */\n.footer {\n  padding: 12px;\n  text-align: center;\n  border-top: 1px solid var(--color-border);\n  background-color: var(--color-background);\n  flex-shrink: 0;\n}\n\n.footer p {\n  font-size: 12px;\n  color: var(--color-text-secondary);\n}\n\n/* Drag and Drop Visual Feedback */\n.drop-highlight {\n  background-color: rgba(0, 120, 212, 0.1) !important;\n  border-color: var(--color-primary) !important;\n}\n\n/* Toast Notification */\n.toast {\n  position: fixed;\n  bottom: 60px;\n  left: 50%;\n  transform: translateX(-50%) translateY(100px);\n  background-color: #323130;\n  color: white;\n  padding: 12px 20px;\n  border-radius: var(--radius-md);\n  font-size: 13px;\n  box-shadow: var(--shadow-md);\n  opacity: 0;\n  transition: all 0.3s ease;\n  z-index: 1000;\n}\n\n.toast.show {\n  transform: translateX(-50%) translateY(0);\n  opacity: 1;\n}\n\n.toast.success {\n  background-color: var(--color-success);\n}\n\n.toast.error {\n  background-color: #d13438;\n}\n\n/* Scrollbar Styling */\n.main-content::-webkit-scrollbar {\n  width: 8px;\n}\n\n.main-content::-webkit-scrollbar-track {\n  background: transparent;\n}\n\n.main-content::-webkit-scrollbar-thumb {\n  background-color: var(--color-border);\n  border-radius: 4px;\n}\n\n.main-content::-webkit-scrollbar-thumb:hover {\n  background-color: #c8c6c4;\n}\n\n/* Animation for expanding categories */\n@keyframes fadeIn {\n  from {\n    opacity: 0;\n    transform: translateY(-10px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n\n.category.expanded .variable-item {\n  animation: fadeIn 0.2s ease;\n}\n\n/* Highlight search match */\n.highlight {\n  background-color: #fff3cd;\n  padding: 1px 2px;\n  border-radius: 2px;\n}\n',""]);const l=i}},n={};function a(r){var t=n[r];if(void 0!==t)return t.exports;var o=n[r]={id:r,exports:{}};return e[r](o,o.exports,a),o.exports}a.n=e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return a.d(n,{a:n}),n},a.d=(e,n)=>{for(var r in n)a.o(n,r)&&!a.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:n[r]})},a.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),a.nc=void 0;var r=a(72),t=a.n(r),o=a(825),i=a.n(o),l=a(659),s=a.n(l),c=a(56),d=a.n(c),p=a(540),u=a.n(p),m=a(113),_=a.n(m),f=a(942),h={};h.styleTagTransform=_(),h.setAttributes=d(),h.insert=s().bind(null,"head"),h.domAPI=i(),h.insertStyleElement=u(),t()(f.A,h),f.A&&f.A.locals&&f.A.locals;const y=[{id:"dossier",name:"Dossier",description:"Variables liées au dossier de financement",variables:[{placeholder:"${C_dossier_id}",type:"C",description:"Identifiant unique du dossier",example:"DOS-2024-001"},{placeholder:"${C_dossier_reference}",type:"C",description:"Référence du dossier",example:"REF-2024-ABC"},{placeholder:"${C_dossier_date_creation}",type:"C",description:"Date de création du dossier",example:"15/01/2024"},{placeholder:"${C_dossier_date_signature}",type:"C",description:"Date de signature du contrat",example:"20/01/2024"},{placeholder:"${C_dossier_statut}",type:"C",description:"Statut actuel du dossier",example:"En cours"},{placeholder:"${C_dossier_montant_finance}",type:"C",description:"Montant total financé",example:"150 000,00 €"},{placeholder:"${C_dossier_duree}",type:"C",description:"Durée du financement en mois",example:"48"},{placeholder:"${C_dossier_taux}",type:"C",description:"Taux d'intérêt appliqué",example:"3,50 %"},{placeholder:"${C_dossier_loyer}",type:"C",description:"Montant du loyer mensuel",example:"3 500,00 €"},{placeholder:"${C_dossier_valeur_residuelle}",type:"C",description:"Valeur résiduelle en fin de contrat",example:"15 000,00 €"},{placeholder:"${B_dossier_avec_assurance}",type:"B",description:"Indique si le dossier inclut une assurance",example:"Oui/Non"},{placeholder:"${B_dossier_avec_maintenance}",type:"B",description:"Indique si le dossier inclut la maintenance",example:"Oui/Non"},{placeholder:"${C_dossier_commentaire}",type:"C",description:"Commentaires sur le dossier",example:"Dossier prioritaire"}]},{id:"dossier_fournisseur",name:"Dossier Fournisseur",description:"Variables liées au dossier côté fournisseur",variables:[{placeholder:"${C_dossier_fournisseur_id}",type:"C",description:"Identifiant du dossier fournisseur",example:"DF-2024-001"},{placeholder:"${C_dossier_fournisseur_reference}",type:"C",description:"Référence fournisseur du dossier",example:"FOUR-REF-001"},{placeholder:"${C_dossier_fournisseur_date_commande}",type:"C",description:"Date de la commande fournisseur",example:"10/01/2024"},{placeholder:"${C_dossier_fournisseur_date_livraison}",type:"C",description:"Date de livraison prévue",example:"25/01/2024"},{placeholder:"${C_dossier_fournisseur_montant_ht}",type:"C",description:"Montant HT de la commande",example:"125 000,00 €"},{placeholder:"${C_dossier_fournisseur_montant_tva}",type:"C",description:"Montant de la TVA",example:"25 000,00 €"},{placeholder:"${C_dossier_fournisseur_montant_ttc}",type:"C",description:"Montant TTC de la commande",example:"150 000,00 €"},{placeholder:"${B_dossier_fournisseur_livre}",type:"B",description:"Indique si la commande est livrée",example:"Oui/Non"},{placeholder:"${B_dossier_fournisseur_facture}",type:"B",description:"Indique si la facture est reçue",example:"Oui/Non"}]},{id:"client",name:"Client",description:"Variables liées aux informations du client",variables:[{placeholder:"${C_client_id}",type:"C",description:"Identifiant unique du client",example:"CLI-001"},{placeholder:"${C_client_raison_sociale}",type:"C",description:"Raison sociale du client",example:"ACME SAS"},{placeholder:"${C_client_siret}",type:"C",description:"Numéro SIRET du client",example:"123 456 789 00012"},{placeholder:"${C_client_siren}",type:"C",description:"Numéro SIREN du client",example:"123 456 789"},{placeholder:"${C_client_adresse}",type:"C",description:"Adresse complète du client",example:"10 rue de la Paix"},{placeholder:"${C_client_code_postal}",type:"C",description:"Code postal du client",example:"75001"},{placeholder:"${C_client_ville}",type:"C",description:"Ville du client",example:"Paris"},{placeholder:"${C_client_pays}",type:"C",description:"Pays du client",example:"France"},{placeholder:"${C_client_telephone}",type:"C",description:"Téléphone du client",example:"01 23 45 67 89"},{placeholder:"${C_client_email}",type:"C",description:"Email du client",example:"contact@acme.fr"},{placeholder:"${C_client_contact_nom}",type:"C",description:"Nom du contact principal",example:"Dupont"},{placeholder:"${C_client_contact_prenom}",type:"C",description:"Prénom du contact principal",example:"Jean"},{placeholder:"${C_client_contact_fonction}",type:"C",description:"Fonction du contact principal",example:"Directeur Financier"},{placeholder:"${C_client_forme_juridique}",type:"C",description:"Forme juridique de l'entreprise",example:"SAS"},{placeholder:"${C_client_capital}",type:"C",description:"Capital social de l'entreprise",example:"100 000,00 €"},{placeholder:"${C_client_naf}",type:"C",description:"Code NAF de l'entreprise",example:"6201Z"},{placeholder:"${C_client_rcs}",type:"C",description:"RCS du client",example:"Paris B 123 456 789"},{placeholder:"${C_client_tva_intra}",type:"C",description:"Numéro de TVA intracommunautaire",example:"FR12345678901"},{placeholder:"${I_client_logo}",type:"I",description:"Logo du client",example:"[Image]"}]},{id:"commercial",name:"Commercial",description:"Variables liées au commercial en charge du dossier",variables:[{placeholder:"${C_commercial_id}",type:"C",description:"Identifiant du commercial",example:"COM-001"},{placeholder:"${C_commercial_nom}",type:"C",description:"Nom du commercial",example:"Martin"},{placeholder:"${C_commercial_prenom}",type:"C",description:"Prénom du commercial",example:"Pierre"},{placeholder:"${C_commercial_email}",type:"C",description:"Email du commercial",example:"p.martin@societe.fr"},{placeholder:"${C_commercial_telephone}",type:"C",description:"Téléphone du commercial",example:"06 12 34 56 78"},{placeholder:"${C_commercial_agence}",type:"C",description:"Agence du commercial",example:"Paris Centre"},{placeholder:"${C_commercial_region}",type:"C",description:"Région du commercial",example:"Île-de-France"},{placeholder:"${I_commercial_signature}",type:"I",description:"Signature du commercial",example:"[Image]"}]},{id:"fournisseur",name:"Fournisseur",description:"Variables liées au fournisseur du matériel",variables:[{placeholder:"${C_fournisseur_id}",type:"C",description:"Identifiant du fournisseur",example:"FOU-001"},{placeholder:"${C_fournisseur_raison_sociale}",type:"C",description:"Raison sociale du fournisseur",example:"Tech Solutions SARL"},{placeholder:"${C_fournisseur_siret}",type:"C",description:"SIRET du fournisseur",example:"987 654 321 00012"},{placeholder:"${C_fournisseur_adresse}",type:"C",description:"Adresse du fournisseur",example:"25 avenue des Technologies"},{placeholder:"${C_fournisseur_code_postal}",type:"C",description:"Code postal du fournisseur",example:"69001"},{placeholder:"${C_fournisseur_ville}",type:"C",description:"Ville du fournisseur",example:"Lyon"},{placeholder:"${C_fournisseur_pays}",type:"C",description:"Pays du fournisseur",example:"France"},{placeholder:"${C_fournisseur_telephone}",type:"C",description:"Téléphone du fournisseur",example:"04 56 78 90 12"},{placeholder:"${C_fournisseur_email}",type:"C",description:"Email du fournisseur",example:"contact@techsolutions.fr"},{placeholder:"${C_fournisseur_contact_nom}",type:"C",description:"Nom du contact fournisseur",example:"Durand"},{placeholder:"${C_fournisseur_contact_prenom}",type:"C",description:"Prénom du contact fournisseur",example:"Marie"},{placeholder:"${C_fournisseur_iban}",type:"C",description:"IBAN du fournisseur",example:"FR76 1234 5678 9012 3456 7890 123"},{placeholder:"${C_fournisseur_bic}",type:"C",description:"BIC du fournisseur",example:"BNPAFRPP"},{placeholder:"${I_fournisseur_logo}",type:"I",description:"Logo du fournisseur",example:"[Image]"}]},{id:"societe_portage",name:"Société de Portage (SPV)",description:"Variables liées à la société de portage",variables:[{placeholder:"${C_spv_id}",type:"C",description:"Identifiant de la SPV",example:"SPV-001"},{placeholder:"${C_spv_raison_sociale}",type:"C",description:"Raison sociale de la SPV",example:"SPV Finance SAS"},{placeholder:"${C_spv_siret}",type:"C",description:"SIRET de la SPV",example:"111 222 333 00012"},{placeholder:"${C_spv_adresse}",type:"C",description:"Adresse de la SPV",example:"5 rue du Portage"},{placeholder:"${C_spv_code_postal}",type:"C",description:"Code postal de la SPV",example:"75008"},{placeholder:"${C_spv_ville}",type:"C",description:"Ville de la SPV",example:"Paris"},{placeholder:"${C_spv_capital}",type:"C",description:"Capital social de la SPV",example:"50 000,00 €"},{placeholder:"${C_spv_rcs}",type:"C",description:"RCS de la SPV",example:"Paris B 111 222 333"},{placeholder:"${C_spv_representant_nom}",type:"C",description:"Nom du représentant légal",example:"Bernard"},{placeholder:"${C_spv_representant_fonction}",type:"C",description:"Fonction du représentant",example:"Président"},{placeholder:"${I_spv_logo}",type:"I",description:"Logo de la SPV",example:"[Image]"}]},{id:"produit",name:"Produit",description:"Variables liées aux produits financés",variables:[{placeholder:"${C_produit_id}",type:"C",description:"Identifiant du produit",example:"PRO-001"},{placeholder:"${C_produit_designation}",type:"C",description:"Désignation du produit",example:"Serveur Dell PowerEdge R750"},{placeholder:"${C_produit_reference}",type:"C",description:"Référence du produit",example:"DELL-R750-XS"},{placeholder:"${C_produit_categorie}",type:"C",description:"Catégorie du produit",example:"Matériel informatique"},{placeholder:"${C_produit_marque}",type:"C",description:"Marque du produit",example:"Dell"},{placeholder:"${C_produit_quantite}",type:"C",description:"Quantité commandée",example:"5"},{placeholder:"${C_produit_prix_unitaire_ht}",type:"C",description:"Prix unitaire HT",example:"8 500,00 €"},{placeholder:"${C_produit_prix_total_ht}",type:"C",description:"Prix total HT",example:"42 500,00 €"},{placeholder:"${C_produit_taux_tva}",type:"C",description:"Taux de TVA applicable",example:"20 %"},{placeholder:"${C_produit_numero_serie}",type:"C",description:"Numéro de série du produit",example:"SN-2024-ABC123"},{placeholder:"${C_produit_date_livraison}",type:"C",description:"Date de livraison du produit",example:"25/01/2024"},{placeholder:"${B_produit_neuf}",type:"B",description:"Indique si le produit est neuf",example:"Oui/Non"},{placeholder:"${T_produits_liste}",type:"T",description:"Tableau de tous les produits du dossier",example:"[Tableau]"}]},{id:"produit_assurance",name:"Produit Assurance",description:"Variables liées à l'assurance des produits",variables:[{placeholder:"${C_assurance_produit_id}",type:"C",description:"Identifiant de l'assurance produit",example:"ASS-PRO-001"},{placeholder:"${C_assurance_produit_type}",type:"C",description:"Type d'assurance",example:"Tous risques"},{placeholder:"${C_assurance_produit_garantie}",type:"C",description:"Nature de la garantie",example:"Dommages matériels"},{placeholder:"${C_assurance_produit_montant}",type:"C",description:"Montant de la prime",example:"250,00 €"},{placeholder:"${C_assurance_produit_franchise}",type:"C",description:"Montant de la franchise",example:"500,00 €"},{placeholder:"${C_assurance_produit_date_debut}",type:"C",description:"Date de début de couverture",example:"01/02/2024"},{placeholder:"${C_assurance_produit_date_fin}",type:"C",description:"Date de fin de couverture",example:"31/01/2028"},{placeholder:"${B_assurance_produit_active}",type:"B",description:"Indique si l'assurance est active",example:"Oui/Non"}]},{id:"caution",name:"Caution",description:"Variables liées aux cautions",variables:[{placeholder:"${C_caution_id}",type:"C",description:"Identifiant de la caution",example:"CAU-001"},{placeholder:"${C_caution_type}",type:"C",description:"Type de caution",example:"Caution personnelle"},{placeholder:"${C_caution_nom}",type:"C",description:"Nom de la caution",example:"Dupont"},{placeholder:"${C_caution_prenom}",type:"C",description:"Prénom de la caution",example:"Jean"},{placeholder:"${C_caution_adresse}",type:"C",description:"Adresse de la caution",example:"15 rue des Lilas"},{placeholder:"${C_caution_code_postal}",type:"C",description:"Code postal de la caution",example:"75015"},{placeholder:"${C_caution_ville}",type:"C",description:"Ville de la caution",example:"Paris"},{placeholder:"${C_caution_montant}",type:"C",description:"Montant de la caution",example:"50 000,00 €"},{placeholder:"${C_caution_date_naissance}",type:"C",description:"Date de naissance",example:"15/06/1970"},{placeholder:"${C_caution_lieu_naissance}",type:"C",description:"Lieu de naissance",example:"Lyon"},{placeholder:"${C_caution_nationalite}",type:"C",description:"Nationalité",example:"Française"},{placeholder:"${B_caution_solidaire}",type:"B",description:"Indique si la caution est solidaire",example:"Oui/Non"},{placeholder:"${T_cautions_liste}",type:"T",description:"Tableau de toutes les cautions",example:"[Tableau]"}]},{id:"mandat_caution",name:"Mandat Caution",description:"Variables liées aux mandats de caution",variables:[{placeholder:"${C_mandat_caution_id}",type:"C",description:"Identifiant du mandat de caution",example:"MAN-CAU-001"},{placeholder:"${C_mandat_caution_reference}",type:"C",description:"Référence du mandat",example:"MC-2024-001"},{placeholder:"${C_mandat_caution_date}",type:"C",description:"Date du mandat",example:"18/01/2024"},{placeholder:"${C_mandat_caution_montant}",type:"C",description:"Montant garanti",example:"75 000,00 €"},{placeholder:"${C_mandat_caution_duree}",type:"C",description:"Durée du mandat",example:"48 mois"},{placeholder:"${C_mandat_caution_beneficiaire}",type:"C",description:"Bénéficiaire du mandat",example:"TD Finance"},{placeholder:"${B_mandat_caution_actif}",type:"B",description:"Indique si le mandat est actif",example:"Oui/Non"}]},{id:"credit_fournisseur",name:"Crédit Fournisseur",description:"Variables liées au crédit fournisseur",variables:[{placeholder:"${C_credit_fournisseur_id}",type:"C",description:"Identifiant du crédit fournisseur",example:"CF-001"},{placeholder:"${C_credit_fournisseur_montant}",type:"C",description:"Montant du crédit fournisseur",example:"25 000,00 €"},{placeholder:"${C_credit_fournisseur_date_debut}",type:"C",description:"Date de début du crédit",example:"01/02/2024"},{placeholder:"${C_credit_fournisseur_date_fin}",type:"C",description:"Date de fin du crédit",example:"01/08/2024"},{placeholder:"${C_credit_fournisseur_taux}",type:"C",description:"Taux appliqué",example:"2,5 %"},{placeholder:"${C_credit_fournisseur_echeances}",type:"C",description:"Nombre d'échéances",example:"6"},{placeholder:"${B_credit_fournisseur_actif}",type:"B",description:"Indique si le crédit est actif",example:"Oui/Non"}]},{id:"attestation_prix_net",name:"Attestation Prix Net Fournisseur",description:"Variables liées à l'attestation de prix net fournisseur",variables:[{placeholder:"${C_attestation_prix_net_id}",type:"C",description:"Identifiant de l'attestation",example:"APN-001"},{placeholder:"${C_attestation_prix_net_date}",type:"C",description:"Date de l'attestation",example:"15/01/2024"},{placeholder:"${C_attestation_prix_net_montant_ht}",type:"C",description:"Montant HT attesté",example:"100 000,00 €"},{placeholder:"${C_attestation_prix_net_montant_remise}",type:"C",description:"Montant de la remise",example:"5 000,00 €"},{placeholder:"${C_attestation_prix_net_montant_final}",type:"C",description:"Montant final après remise",example:"95 000,00 €"},{placeholder:"${C_attestation_prix_net_validite}",type:"C",description:"Durée de validité",example:"30 jours"},{placeholder:"${B_attestation_prix_net_valide}",type:"B",description:"Indique si l'attestation est valide",example:"Oui/Non"}]},{id:"societe_assurance",name:"Société (Assurance)",description:"Variables liées à la société d'assurance",variables:[{placeholder:"${C_societe_assurance_id}",type:"C",description:"Identifiant de la société d'assurance",example:"SOC-ASS-001"},{placeholder:"${C_societe_assurance_nom}",type:"C",description:"Nom de la société d'assurance",example:"Allianz"},{placeholder:"${C_societe_assurance_adresse}",type:"C",description:"Adresse de la société",example:"1 cours Michelet"},{placeholder:"${C_societe_assurance_code_postal}",type:"C",description:"Code postal",example:"92800"},{placeholder:"${C_societe_assurance_ville}",type:"C",description:"Ville",example:"Puteaux"},{placeholder:"${C_societe_assurance_telephone}",type:"C",description:"Téléphone",example:"01 40 00 00 00"},{placeholder:"${C_societe_assurance_email}",type:"C",description:"Email de contact",example:"contact@allianz.fr"},{placeholder:"${C_societe_assurance_numero_agrement}",type:"C",description:"Numéro d'agrément",example:"AGR-123456"},{placeholder:"${I_societe_assurance_logo}",type:"I",description:"Logo de la société d'assurance",example:"[Image]"}]},{id:"simulation",name:"Simulation",description:"Variables liées aux simulations de financement",variables:[{placeholder:"${C_simulation_id}",type:"C",description:"Identifiant de la simulation",example:"SIM-001"},{placeholder:"${C_simulation_date}",type:"C",description:"Date de la simulation",example:"10/01/2024"},{placeholder:"${C_simulation_montant}",type:"C",description:"Montant simulé",example:"100 000,00 €"},{placeholder:"${C_simulation_duree}",type:"C",description:"Durée de financement simulée",example:"48 mois"},{placeholder:"${C_simulation_taux}",type:"C",description:"Taux simulé",example:"3,25 %"},{placeholder:"${C_simulation_loyer}",type:"C",description:"Loyer mensuel simulé",example:"2 350,00 €"},{placeholder:"${C_simulation_premier_loyer}",type:"C",description:"Premier loyer majoré",example:"5 000,00 €"},{placeholder:"${C_simulation_valeur_residuelle}",type:"C",description:"Valeur résiduelle simulée",example:"10 000,00 €"},{placeholder:"${C_simulation_cout_total}",type:"C",description:"Coût total du financement",example:"117 800,00 €"},{placeholder:"${C_simulation_periodicite}",type:"C",description:"Périodicité des loyers",example:"Mensuel"},{placeholder:"${B_simulation_avec_assurance}",type:"B",description:"Simulation avec assurance",example:"Oui/Non"},{placeholder:"${T_simulation_echeancier}",type:"T",description:"Tableau de l'échéancier simulé",example:"[Tableau]"}]}];function C(){const e=[];return y.forEach(n=>{n.variables.forEach(a=>{e.push({...a,categoryId:n.id,categoryName:n.name})})}),e}const x="tdprint_favorites";let v=[],g="";function b(){!function(){try{const e=localStorage.getItem(x);v=e?JSON.parse(e):[]}catch(e){console.error("Erreur de chargement des favoris:",e),v=[]}}(),function(){const e=document.getElementById("categoriesContainer");e.innerHTML=y.map(e=>`\n      <div class="category" data-category-id="${e.id}">\n        <div class="category-header" onclick="toggleCategory('${e.id}')">\n          <div class="category-header-left">\n            <span class="category-icon">\n              <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">\n                <path d="M6 4l4 4-4 4V4z"/>\n              </svg>\n            </span>\n            <span class="category-name">${e.name}</span>\n          </div>\n          <span class="badge-count">${e.variables.length}</span>\n        </div>\n        <div class="category-content">\n          <div class="variables-list">\n            ${e.variables.map(n=>S({...n,categoryName:e.name})).join("")}\n          </div>\n        </div>\n      </div>\n    `).join(""),y.forEach(n=>{w(e.querySelector(`[data-category-id="${n.id}"]`).querySelector(".variables-list"))})}(),I(),function(){const e=document.getElementById("searchInput"),n=document.getElementById("clearSearch");e.addEventListener("input",e=>{g=e.target.value.trim(),n.classList.toggle("visible",g.length>0),k()}),n.addEventListener("click",()=>{e.value="",g="",n.classList.remove("visible"),k()}),document.addEventListener("keydown",a=>{"Escape"===a.key&&g&&(e.value="",g="",n.classList.remove("visible"),k()),(a.ctrlKey||a.metaKey)&&"f"===a.key&&(a.preventDefault(),e.focus())})}()}function $(e){return v.includes(e)}function I(){const e=document.getElementById("favoritesSection"),n=document.getElementById("favoritesContainer"),a=document.getElementById("favoritesCount");if(0===v.length)return void e.classList.add("hidden");e.classList.remove("hidden"),a.textContent=v.length;const r=C(),t=v.map(e=>r.find(n=>n.placeholder===e)).filter(Boolean);n.innerHTML=t.map(e=>S(e,!0)).join(""),w(n)}function S(e,n=!1){const a=$(e.placeholder),r=`type-${e.type}`,t={C:"Champ",B:"Booléen",I:"Image",T:"Tableau"}[o=e.type]||o;var o;return`\n    <div class="variable-item"\n         draggable="true"\n         data-placeholder="${e.placeholder}"\n         data-type="${e.type}">\n      <div class="variable-main">\n        <div class="variable-header">\n          <span class="variable-placeholder">${L(e.placeholder,g)}</span>\n          <span class="variable-type ${r}" title="${t}">${e.type}</span>\n        </div>\n        <div class="variable-description">${L(e.description,g)}</div>\n        ${n&&e.categoryName?`<div class="variable-category">${L(e.categoryName,g)}</div>`:""}\n      </div>\n      <button class="favorite-btn ${a?"active":""}"\n              data-placeholder="${e.placeholder}"\n              title="${a?"Retirer des favoris":"Ajouter aux favoris"}">\n        <svg viewBox="0 0 16 16" fill="currentColor">\n          ${a?'<path d="M8 1.5l1.854 3.758 4.146.603-3 2.923.708 4.13L8 11.062l-3.708 1.852.708-4.13-3-2.923 4.146-.603L8 1.5z"/>':'<path d="M8 1.5l1.854 3.758 4.146.603-3 2.923.708 4.13L8 11.062l-3.708 1.852.708-4.13-3-2.923 4.146-.603L8 1.5zm0 2.445L6.764 6.36l-2.682.39 1.941 1.891-.458 2.67L8 9.857l2.435 1.28-.458-2.67 1.941-1.891-2.682-.39L8 3.945z"/>'}\n        </svg>\n      </button>\n      <button class="insert-btn" data-placeholder="${e.placeholder}" title="Insérer">\n        Insérer\n      </button>\n    </div>\n  `}function w(e){e.querySelectorAll(".variable-item").forEach(e=>{e.addEventListener("dragstart",T),e.addEventListener("dragend",E)}),e.querySelectorAll(".favorite-btn").forEach(e=>{e.addEventListener("click",n=>{n.stopPropagation(),function(e){const n=v.indexOf(e);-1===n?(v.push(e),A("Ajouté aux favoris","success")):(v.splice(n,1),A("Retiré des favoris")),function(){try{localStorage.setItem(x,JSON.stringify(v))}catch(e){console.error("Erreur de sauvegarde des favoris:",e)}}(),I(),document.querySelectorAll(".favorite-btn").forEach(e=>{const n=e.dataset.placeholder;e.classList.toggle("active",$(n))})}(e.dataset.placeholder)})}),e.querySelectorAll(".insert-btn").forEach(e=>{e.addEventListener("click",n=>{n.stopPropagation(),async function(e){if("undefined"!=typeof Word&&Word.run)try{await Word.run(async n=>{n.document.getSelection().insertText(e,Word.InsertLocation.replace),await n.sync()}),A(`Variable insérée: ${e}`,"success")}catch(e){console.error("Erreur d'insertion:",e),A("Erreur lors de l'insertion","error")}else try{await navigator.clipboard.writeText(e),A(`Copié: ${e}`,"success")}catch(n){A(`Variable: ${e}`,"success")}}(e.dataset.placeholder)})})}function k(){const e=document.getElementById("noResults"),n=g.toLowerCase();let a=!1;y.forEach(e=>{const r=document.querySelector(`[data-category-id="${e.id}"]`),t=r.querySelector(".variables-list");let o=!1;e.variables.forEach(r=>{const i=t.querySelector(`[data-placeholder="${r.placeholder}"]`);if(!i)return;const l=!n||r.placeholder.toLowerCase().includes(n)||r.description.toLowerCase().includes(n)||e.name.toLowerCase().includes(n);i.style.display=l?"":"none",l&&(o=!0,a=!0)}),r.style.display=o?"":"none",n&&o&&r.classList.add("expanded"),n&&(t.innerHTML=e.variables.map(n=>S({...n,categoryName:e.name})).join(""),w(t),e.variables.forEach(a=>{const r=t.querySelector(`[data-placeholder="${a.placeholder}"]`);if(!r)return;const o=a.placeholder.toLowerCase().includes(n)||a.description.toLowerCase().includes(n)||e.name.toLowerCase().includes(n);r.style.display=o?"":"none"}))}),I(),n&&document.getElementById("favoritesContainer").querySelectorAll(".variable-item").forEach(e=>{const r=e.dataset.placeholder,t=C().find(e=>e.placeholder===r);if(!t)return;const o=t.placeholder.toLowerCase().includes(n)||t.description.toLowerCase().includes(n)||t.categoryName&&t.categoryName.toLowerCase().includes(n);e.style.display=o?"":"none",o&&(a=!0)}),e.classList.toggle("hidden",a||!n)}function L(e,n){if(!n)return e;const a=new RegExp(`(${r=n,r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"gi");var r;return e.replace(a,'<span class="highlight">$1</span>')}function T(e){const n=e.target.dataset.placeholder||e.target.closest(".variable-item").dataset.placeholder;e.dataTransfer.setData("text/plain",n),e.dataTransfer.effectAllowed="copy",e.target.classList.add("dragging")}function E(e){e.target.classList.remove("dragging")}function A(e,n=""){const a=document.querySelector(".toast");a&&a.remove();const r=document.createElement("div");r.className=`toast ${n}`,r.textContent=e,document.body.appendChild(r),requestAnimationFrame(()=>{r.classList.add("show")}),setTimeout(()=>{r.classList.remove("show"),setTimeout(()=>r.remove(),300)},2e3)}Office.onReady(e=>{b()}),"undefined"==typeof Office&&document.addEventListener("DOMContentLoaded",b),window.toggleCategory=function(e){const n=document.querySelector(`[data-category-id="${e}"]`);n&&n.classList.toggle("expanded")}})();