(()=>{"use strict";var e={56(e,i,r){e.exports=function(e){var i=r.nc;i&&e.setAttribute("nonce",i)}},72(e){var i=[];function r(e){for(var r=-1,o=0;o<i.length;o++)if(i[o].identifier===e){r=o;break}return r}function o(e,o){for(var n={},a=[],s=0;s<e.length;s++){var d=e[s],l=o.base?d[0]+o.base:d[0],p=n[l]||0,c="".concat(l," ").concat(p);n[l]=p+1;var u=r(c),C={css:d[1],media:d[2],sourceMap:d[3],supports:d[4],layer:d[5]};if(-1!==u)i[u].references++,i[u].updater(C);else{var _=t(C,o);o.byIndex=s,i.splice(s,0,{identifier:c,updater:_,references:1})}a.push(c)}return a}function t(e,i){var r=i.domAPI(i);return r.update(e),function(i){if(i){if(i.css===e.css&&i.media===e.media&&i.sourceMap===e.sourceMap&&i.supports===e.supports&&i.layer===e.layer)return;r.update(e=i)}else r.remove()}}e.exports=function(e,t){var n=o(e=e||[],t=t||{});return function(e){e=e||[];for(var a=0;a<n.length;a++){var s=r(n[a]);i[s].references--}for(var d=o(e,t),l=0;l<n.length;l++){var p=r(n[l]);0===i[p].references&&(i[p].updater(),i.splice(p,1))}n=d}}},113(e){e.exports=function(e,i){if(i.styleSheet)i.styleSheet.cssText=e;else{for(;i.firstChild;)i.removeChild(i.firstChild);i.appendChild(document.createTextNode(e))}}},314(e){e.exports=function(e){var i=[];return i.toString=function(){return this.map(function(i){var r="",o=void 0!==i[5];return i[4]&&(r+="@supports (".concat(i[4],") {")),i[2]&&(r+="@media ".concat(i[2]," {")),o&&(r+="@layer".concat(i[5].length>0?" ".concat(i[5]):""," {")),r+=e(i),o&&(r+="}"),i[2]&&(r+="}"),i[4]&&(r+="}"),r}).join("")},i.i=function(e,r,o,t,n){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(o)for(var s=0;s<this.length;s++){var d=this[s][0];null!=d&&(a[d]=!0)}for(var l=0;l<e.length;l++){var p=[].concat(e[l]);o&&a[p[0]]||(void 0!==n&&(void 0===p[5]||(p[1]="@layer".concat(p[5].length>0?" ".concat(p[5]):""," {").concat(p[1],"}")),p[5]=n),r&&(p[2]?(p[1]="@media ".concat(p[2]," {").concat(p[1],"}"),p[2]=r):p[2]=r),t&&(p[4]?(p[1]="@supports (".concat(p[4],") {").concat(p[1],"}"),p[4]=t):p[4]="".concat(t)),i.push(p))}},i}},540(e){e.exports=function(e){var i=document.createElement("style");return e.setAttributes(i,e.attributes),e.insert(i,e.options),i}},601(e){e.exports=function(e){return e[1]}},659(e){var i={};e.exports=function(e,r){var o=function(e){if(void 0===i[e]){var r=document.querySelector(e);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(e){r=null}i[e]=r}return i[e]}(e);if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(r)}},825(e){e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var i=e.insertStyleElement(e);return{update:function(r){!function(e,i,r){var o="";r.supports&&(o+="@supports (".concat(r.supports,") {")),r.media&&(o+="@media ".concat(r.media," {"));var t=void 0!==r.layer;t&&(o+="@layer".concat(r.layer.length>0?" ".concat(r.layer):""," {")),o+=r.css,t&&(o+="}"),r.media&&(o+="}"),r.supports&&(o+="}");var n=r.sourceMap;n&&"undefined"!=typeof btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(n))))," */")),i.styleTagTransform(o,e,i.options)}(i,e,r)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(i)}}}},942(e,i,r){r.d(i,{A:()=>s});var o=r(601),t=r.n(o),n=r(314),a=r.n(n)()(t());a.push([e.id,'/* Variables CSS - Fluent UI Design */\n:root {\n  --color-primary: #0078d4;\n  --color-primary-dark: #106ebe;\n  --color-success: #107c10;\n  --color-warning: #d83b01;\n  --color-purple: #8764b8;\n  --color-text: #323130;\n  --color-text-secondary: #605e5c;\n  --color-background: #ffffff;\n  --color-background-hover: #f3f2f1;\n  --color-background-active: #edebe9;\n  --color-border: #e1dfdd;\n  --color-favorite: #ffb900;\n  --shadow-sm: 0 1.6px 3.6px 0 rgba(0, 0, 0, 0.132), 0 0.3px 0.9px 0 rgba(0, 0, 0, 0.108);\n  --shadow-md: 0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132), 0 0.6px 1.8px 0 rgba(0, 0, 0, 0.108);\n  --radius-sm: 4px;\n  --radius-md: 8px;\n  --font-family: "Segoe UI", -apple-system, BlinkMacSystemFont, sans-serif;\n}\n\n/* Reset */\n*, *::before, *::after {\n  box-sizing: border-box;\n  margin: 0;\n  padding: 0;\n}\n\n/* Base */\nhtml, body {\n  height: 100%;\n  font-family: var(--font-family);\n  font-size: 14px;\n  color: var(--color-text);\n  background-color: var(--color-background);\n  overflow: hidden;\n}\n\n#app {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n}\n\n/* Header */\n.header {\n  padding: 16px;\n  background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-primary-dark) 100%);\n  color: white;\n  flex-shrink: 0;\n}\n\n.header-title {\n  display: flex;\n  align-items: center;\n  gap: 10px;\n  margin-bottom: 12px;\n}\n\n.header-logo {\n  width: 28px;\n  height: 28px;\n}\n\n.header-title h1 {\n  font-size: 18px;\n  font-weight: 600;\n}\n\n/* Search */\n.search-container {\n  position: relative;\n}\n\n.search-input {\n  width: 100%;\n  padding: 10px 36px 10px 12px;\n  border: none;\n  border-radius: var(--radius-sm);\n  font-size: 14px;\n  font-family: var(--font-family);\n  outline: none;\n  transition: box-shadow 0.2s;\n}\n\n.search-input:focus {\n  box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.4);\n}\n\n.search-input::placeholder {\n  color: var(--color-text-secondary);\n}\n\n.clear-search {\n  position: absolute;\n  right: 8px;\n  top: 50%;\n  transform: translateY(-50%);\n  background: none;\n  border: none;\n  padding: 6px;\n  cursor: pointer;\n  color: var(--color-text-secondary);\n  border-radius: var(--radius-sm);\n  display: none;\n  transition: background-color 0.2s;\n}\n\n.clear-search:hover {\n  background-color: var(--color-background-hover);\n}\n\n.clear-search.visible {\n  display: flex;\n}\n\n/* Main Content */\n.main-content {\n  flex: 1;\n  overflow-y: auto;\n  padding: 8px;\n}\n\n/* Favorites Section */\n.favorites-section {\n  margin-bottom: 8px;\n  background-color: #fffef5;\n  border: 1px solid #fff3cd;\n  border-radius: var(--radius-md);\n  overflow: hidden;\n}\n\n.favorites-section.hidden {\n  display: none;\n}\n\n.favorites-header {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 12px;\n  background-color: #fff8e1;\n  color: #8a6d3b;\n  font-weight: 600;\n}\n\n.favorites-header .section-icon {\n  color: var(--color-favorite);\n}\n\n/* Category Accordion */\n.category {\n  margin-bottom: 4px;\n  border: 1px solid var(--color-border);\n  border-radius: var(--radius-md);\n  overflow: hidden;\n}\n\n.category-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 12px;\n  background-color: var(--color-background);\n  cursor: pointer;\n  user-select: none;\n  transition: background-color 0.2s;\n}\n\n.category-header:hover {\n  background-color: var(--color-background-hover);\n}\n\n.category-header-left {\n  display: flex;\n  align-items: center;\n  gap: 10px;\n}\n\n.category-icon {\n  width: 20px;\n  height: 20px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: transform 0.2s;\n}\n\n.category.expanded .category-icon {\n  transform: rotate(90deg);\n}\n\n.category-name {\n  font-weight: 600;\n  font-size: 14px;\n}\n\n.badge-count {\n  background-color: var(--color-primary);\n  color: white;\n  padding: 2px 8px;\n  border-radius: 12px;\n  font-size: 12px;\n  font-weight: 500;\n}\n\n.category-content {\n  display: none;\n  border-top: 1px solid var(--color-border);\n}\n\n.category.expanded .category-content {\n  display: block;\n}\n\n/* Variables List */\n.variables-list {\n  padding: 8px;\n}\n\n/* Variable Item */\n.variable-item {\n  display: flex;\n  align-items: flex-start;\n  gap: 10px;\n  padding: 10px;\n  margin-bottom: 4px;\n  background-color: var(--color-background);\n  border: 1px solid var(--color-border);\n  border-radius: var(--radius-sm);\n  cursor: grab;\n  transition: all 0.2s;\n}\n\n.variable-item:hover {\n  background-color: var(--color-background-hover);\n  border-color: var(--color-primary);\n  box-shadow: var(--shadow-sm);\n}\n\n.variable-item:active {\n  cursor: grabbing;\n}\n\n.variable-item.dragging {\n  opacity: 0.5;\n  transform: scale(0.98);\n}\n\n.variable-main {\n  flex: 1;\n  min-width: 0;\n}\n\n.variable-header {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  margin-bottom: 4px;\n}\n\n.variable-placeholder {\n  font-family: "Consolas", "Monaco", monospace;\n  font-size: 13px;\n  color: var(--color-primary);\n  font-weight: 500;\n  word-break: break-all;\n}\n\n.variable-type {\n  padding: 2px 6px;\n  border-radius: 3px;\n  font-size: 10px;\n  font-weight: 600;\n  color: white;\n  flex-shrink: 0;\n}\n\n.variable-type.type-C {\n  background-color: var(--color-primary);\n}\n\n.variable-type.type-B {\n  background-color: var(--color-success);\n}\n\n.variable-type.type-I {\n  background-color: var(--color-purple);\n}\n\n.variable-type.type-T {\n  background-color: var(--color-warning);\n}\n\n.variable-description {\n  font-size: 12px;\n  color: var(--color-text-secondary);\n  line-height: 1.4;\n}\n\n.variable-category {\n  font-size: 11px;\n  color: var(--color-text-secondary);\n  margin-top: 4px;\n  font-style: italic;\n}\n\n/* Favorite Button */\n.favorite-btn {\n  background: none;\n  border: none;\n  padding: 4px;\n  cursor: pointer;\n  color: var(--color-border);\n  border-radius: var(--radius-sm);\n  transition: all 0.2s;\n  flex-shrink: 0;\n}\n\n.favorite-btn:hover {\n  color: var(--color-favorite);\n  transform: scale(1.1);\n}\n\n.favorite-btn.active {\n  color: var(--color-favorite);\n}\n\n.favorite-btn svg {\n  width: 18px;\n  height: 18px;\n}\n\n/* Insert Button */\n.insert-btn {\n  background-color: var(--color-primary);\n  color: white;\n  border: none;\n  padding: 6px 10px;\n  border-radius: var(--radius-sm);\n  font-size: 12px;\n  font-weight: 500;\n  cursor: pointer;\n  transition: background-color 0.2s;\n  flex-shrink: 0;\n}\n\n.insert-btn:hover {\n  background-color: var(--color-primary-dark);\n}\n\n/* No Results */\n.no-results {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  padding: 40px 20px;\n  text-align: center;\n}\n\n.no-results.hidden {\n  display: none;\n}\n\n.no-results p {\n  margin-top: 16px;\n  color: var(--color-text-secondary);\n  font-size: 14px;\n}\n\n/* Footer */\n.footer {\n  padding: 12px;\n  text-align: center;\n  border-top: 1px solid var(--color-border);\n  background-color: var(--color-background);\n  flex-shrink: 0;\n}\n\n.footer p {\n  font-size: 12px;\n  color: var(--color-text-secondary);\n}\n\n/* Drag and Drop Visual Feedback */\n.drop-highlight {\n  background-color: rgba(0, 120, 212, 0.1) !important;\n  border-color: var(--color-primary) !important;\n}\n\n/* Toast Notification */\n.toast {\n  position: fixed;\n  bottom: 60px;\n  left: 50%;\n  transform: translateX(-50%) translateY(100px);\n  background-color: #323130;\n  color: white;\n  padding: 12px 20px;\n  border-radius: var(--radius-md);\n  font-size: 13px;\n  box-shadow: var(--shadow-md);\n  opacity: 0;\n  transition: all 0.3s ease;\n  z-index: 1000;\n}\n\n.toast.show {\n  transform: translateX(-50%) translateY(0);\n  opacity: 1;\n}\n\n.toast.success {\n  background-color: var(--color-success);\n}\n\n.toast.error {\n  background-color: #d13438;\n}\n\n/* Scrollbar Styling */\n.main-content::-webkit-scrollbar {\n  width: 8px;\n}\n\n.main-content::-webkit-scrollbar-track {\n  background: transparent;\n}\n\n.main-content::-webkit-scrollbar-thumb {\n  background-color: var(--color-border);\n  border-radius: 4px;\n}\n\n.main-content::-webkit-scrollbar-thumb:hover {\n  background-color: #c8c6c4;\n}\n\n/* Animation for expanding categories */\n@keyframes fadeIn {\n  from {\n    opacity: 0;\n    transform: translateY(-10px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n\n.category.expanded .variable-item {\n  animation: fadeIn 0.2s ease;\n}\n\n/* Highlight search match */\n.highlight {\n  background-color: #fff3cd;\n  padding: 1px 2px;\n  border-radius: 2px;\n}\n',""]);const s=a}},i={};function r(o){var t=i[o];if(void 0!==t)return t.exports;var n=i[o]={id:o,exports:{}};return e[o](n,n.exports,r),n.exports}r.n=e=>{var i=e&&e.__esModule?()=>e.default:()=>e;return r.d(i,{a:i}),i},r.d=(e,i)=>{for(var o in i)r.o(i,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:i[o]})},r.o=(e,i)=>Object.prototype.hasOwnProperty.call(e,i),r.nc=void 0;var o=r(72),t=r.n(o),n=r(825),a=r.n(n),s=r(659),d=r.n(s),l=r(56),p=r.n(l),c=r(540),u=r.n(c),C=r(113),_=r.n(C),m=r(942),h={};h.styleTagTransform=_(),h.setAttributes=p(),h.insert=d().bind(null,"head"),h.domAPI=a(),h.insertStyleElement=u(),t()(m.A,h),m.A&&m.A.locals&&m.A.locals;const y=[{id:"dossier",name:"Dossier",description:"Variables liées au dossier de financement principal",variables:[{placeholder:"${C_dossier_id}",type:"C",description:"Identifiant unique UUID du dossier"},{placeholder:"${C_dossier_numero}",type:"C",description:"Numéro de contrat ou numéro de mandat"},{placeholder:"${C_dossier_identifiant}",type:"C",description:"Identifiant du dossier"},{placeholder:"${C_dossier_territoire}",type:"C",description:"Code territoire (REU, GUA, MAR, TAH, NCA)"},{placeholder:"${C_dossier_agence}",type:"C",description:"Code agence"},{placeholder:"${C_dossier_annee}",type:"C",description:"Année du dossier"},{placeholder:"${C_dossier_raisonSociale}",type:"C",description:"Raison sociale du gérant (2IOM ou JPO)"},{placeholder:"${C_dossier_client}",type:"C",description:"URL API du client"},{placeholder:"${C_dossier_assurance}",type:"C",description:"URL API de la compagnie d'assurance"},{placeholder:"${C_dossier_banque}",type:"C",description:"URL API de la banque"},{placeholder:"${C_dossier_spv}",type:"C",description:"URL API de la SPV"},{placeholder:"${C_dossier_commercial}",type:"C",description:"URL API du commercial"},{placeholder:"${C_dossier_fournisseur}",type:"C",description:"URL API du fournisseur"},{placeholder:"${C_dossier_produit}",type:"C",description:"URL API du premier produit"},{placeholder:"${C_dossier_echeancier}",type:"C",description:"URL API de l'échéancier legacy"},{placeholder:"${C_dossier_dateContratLocation}",type:"C",description:"Date du contrat de location"},{placeholder:"${C_dossier_dateFinLocation}",type:"C",description:"Date de fin de location"},{placeholder:"${C_dossier_dateLivraison}",type:"C",description:"Date de livraison effective ou prévisionnelle"},{placeholder:"${C_dossier_dateAccordFinancement}",type:"C",description:"Date d'accord de financement"},{placeholder:"${C_dossier_dateAccordFinancementComplete}",type:"C",description:"Date d'accord en toutes lettres"},{placeholder:"${C_dossier_dateSignature}",type:"C",description:"Date de signature (date du jour)"},{placeholder:"${C_dossier_anneeAccordFinancementLettre}",type:"C",description:"Année d'accord en toutes lettres"},{placeholder:"${C_dossier_anneeMoins1}",type:"C",description:"Année précédente"},{placeholder:"${C_dossier_devise}",type:"C",description:"Symbole de la devise"},{placeholder:"${C_dossier_deviseLettre}",type:"C",description:"Devise en toutes lettres"},{placeholder:"${C_dossier_montantProduitHT}",type:"C",description:"Montant HT des produits"},{placeholder:"${C_dossier_montantProduitTTC}",type:"C",description:"Montant TTC des produits"},{placeholder:"${C_dossier_montantProduitHtLettre}",type:"C",description:"Montant HT en toutes lettres"},{placeholder:"${C_dossier_montantProduitTTCLettre}",type:"C",description:"Montant TTC en toutes lettres"},{placeholder:"${C_dossier_montantTva}",type:"C",description:"Montant de la TVA"},{placeholder:"${C_dossier_pourcentageTva}",type:"C",description:"Taux de TVA"},{placeholder:"${C_dossier_depotGarantie}",type:"C",description:"Montant du dépôt de garantie"},{placeholder:"${C_dossier_tauxDepotGarantie}",type:"C",description:"Taux du dépôt de garantie"},{placeholder:"${C_dossier_montantPret}",type:"C",description:"Montant du prêt bancaire"},{placeholder:"${C_dossier_montantPretLettre}",type:"C",description:"Montant du prêt en toutes lettres"},{placeholder:"${C_dossier_montantComplement}",type:"C",description:"Montant du complément"},{placeholder:"${C_dossier_montantComplementLettre}",type:"C",description:"Montant du complément en toutes lettres"},{placeholder:"${C_dossier_apportSpv}",type:"C",description:"Apport de la SPV"},{placeholder:"${C_dossier_tauxApportSpv}",type:"C",description:"Taux de l'apport SPV"},{placeholder:"${C_dossier_tauxMontantComplement}",type:"C",description:"Taux du complément"},{placeholder:"${C_dossier_apportLocataire}",type:"C",description:"Apport du locataire"},{placeholder:"${C_dossier_apportLocataireLettre}",type:"C",description:"Apport locataire en toutes lettres"},{placeholder:"${C_dossier_montantoa}",type:"C",description:"Montant de l'apport locataire"},{placeholder:"${C_dossier_montantSofidom}",type:"C",description:"Montant Sofidom"},{placeholder:"${C_dossier_valeurResiduelle}",type:"C",description:"Valeur résiduelle"},{placeholder:"${C_dossier_dureeLocation}",type:"C",description:"Durée de la location (en périodes)"},{placeholder:"${C_dossier_dureeLocationEnMois}",type:"C",description:"Durée de la location en mois"},{placeholder:"${C_dossier_dureeEmprunt}",type:"C",description:"Durée du prêt en mois"},{placeholder:"${C_dossier_periodiciteFacturationLoyer}",type:"C",description:"Périodicité de facturation"},{placeholder:"${C_dossier_nombreEcheance}",type:"C",description:"Nombre d'échéances"},{placeholder:"${C_dossier_loyerNetHt}",type:"C",description:"Loyer net HT"},{placeholder:"${C_dossier_loyerTtc}",type:"C",description:"Loyer TTC"},{placeholder:"${C_dossier_loyerTva}",type:"C",description:"TVA sur loyer"},{placeholder:"${C_dossier_tauxPret}",type:"C",description:"Taux du prêt"},{placeholder:"${C_dossier_dureePeriode1}",type:"C",description:"Durée de la période 1"},{placeholder:"${C_dossier_montantNetHt1}",type:"C",description:"Montant HT période 1"},{placeholder:"${C_dossier_montantTtc1}",type:"C",description:"Montant TTC période 1"},{placeholder:"${C_dossier_montantTva1}",type:"C",description:"TVA période 1"},{placeholder:"${B_dossier_hasPeriode1}",type:"B",description:"Période 1 existe"},{placeholder:"${C_dossier_dureePeriode2}",type:"C",description:"Durée de la période 2"},{placeholder:"${C_dossier_montantNetHt2}",type:"C",description:"Montant HT période 2"},{placeholder:"${C_dossier_montantTtc2}",type:"C",description:"Montant TTC période 2"},{placeholder:"${C_dossier_montantTva2}",type:"C",description:"TVA période 2"},{placeholder:"${B_dossier_hasPeriode2}",type:"B",description:"Période 2 existe"},{placeholder:"${C_dossier_dureePeriode3}",type:"C",description:"Durée de la période 3"},{placeholder:"${C_dossier_montantNetHt3}",type:"C",description:"Montant HT période 3"},{placeholder:"${C_dossier_montantTtc3}",type:"C",description:"Montant TTC période 3"},{placeholder:"${C_dossier_montantTva3}",type:"C",description:"TVA période 3"},{placeholder:"${B_dossier_hasPeriode3}",type:"B",description:"Période 3 existe"},{placeholder:"${C_dossier_totalMontantNetHt}",type:"C",description:"Total HT de toutes les périodes"},{placeholder:"${C_dossier_totalMontantTtc}",type:"C",description:"Total TTC de toutes les périodes"},{placeholder:"${B_dossier_isCreditBail}",type:"B",description:"Dossier en crédit-bail"},{placeholder:"${B_dossier_isCreditRelais}",type:"B",description:"Dossier en crédit relais"},{placeholder:"${B_dossier_isLdd}",type:"B",description:"Location de longue durée"},{placeholder:"${B_dossier_isDefiscalisation}",type:"B",description:"Dossier défiscalisé"},{placeholder:"${B_dossier_isLocataireFournisseur}",type:"B",description:"Le locataire est fournisseur"},{placeholder:"${B_dossier_isNotLocataireFournisseur}",type:"B",description:"Le locataire n'est pas fournisseur"},{placeholder:"${B_dossier_isPaiementLocataire}",type:"B",description:"Paiement par le locataire"},{placeholder:"${B_dossier_pretLineaire}",type:"B",description:"Prêt de type linéaire"},{placeholder:"${B_dossier_pretClassique}",type:"B",description:"Prêt de type classique"},{placeholder:"${B_dossier_onePeriod}",type:"B",description:"Une seule période de loyer"},{placeholder:"${B_dossier_multiPeriod}",type:"B",description:"Plusieurs périodes de loyer"},{placeholder:"${B_dossier_isBanque}",type:"B",description:"Dossier avec financement bancaire"},{placeholder:"${B_dossier_isNotBanque}",type:"B",description:"Dossier sans financement bancaire"},{placeholder:"${B_dossier_isSofidom}",type:"B",description:"Financement Sofidom"},{placeholder:"${B_dossier_isPretExterne}",type:"B",description:"Prêt externe (non Sofidom)"},{placeholder:"${B_dossier_hasTVA}",type:"B",description:"TVA applicable"},{placeholder:"${B_dossier_hasNotTVA}",type:"B",description:"TVA non applicable"},{placeholder:"${B_dossier_isLOA}",type:"B",description:"Location avec Option d'Achat"},{placeholder:"${B_dossier_isNotLOA}",type:"B",description:"Pas une LOA"},{placeholder:"${B_dossier_hasDepotDeGarantie}",type:"B",description:"Dépôt de garantie présent"},{placeholder:"${B_dossier_hasNotDepotDeGarantie}",type:"B",description:"Pas de dépôt de garantie"},{placeholder:"${B_dossier_isActiviteTouristique}",type:"B",description:"Activité touristique"},{placeholder:"${B_dossier_isDom}",type:"B",description:"Dossier DOM"},{placeholder:"${B_dossier_isInterinvest}",type:"B",description:"Gérant Inter Invest"},{placeholder:"${B_dossier_isJpo}",type:"B",description:"Gérant JP Ocean"},{placeholder:"${B_dossier_isReunion}",type:"B",description:"Agence Réunion"},{placeholder:"${B_dossier_isNotReunion}",type:"B",description:"Pas agence Réunion"},{placeholder:"${B_dossier_isTah}",type:"B",description:"Agence Tahiti"},{placeholder:"${B_dossier_isNca}",type:"B",description:"Agence Nouvelle-Calédonie"},{placeholder:"${B_dossier_agrementDgfip}",type:"B",description:"Agrément DGFIP requis"},{placeholder:"${C_dossier_agrementDgfiReponse}",type:"C",description:"Réponse agrément (Oui/Non)"},{placeholder:"${B_dossier_isPolynesie}",type:"B",description:"Territoire Polynésie"},{placeholder:"${B_dossier_hasImmat}",type:"B",description:"Produit avec immatriculation"},{placeholder:"${B_dossier_hasSerie}",type:"B",description:"Produit avec numéro de série"},{placeholder:"${C_dossier_recapitulatifProduits}",type:"C",description:"Description des produits"},{placeholder:"${C_dossier_recapitulatifProduit}",type:"C",description:"Description du produit principal"},{placeholder:"${C_dossier_numeroImmatriculation}",type:"C",description:"Numéros d'immatriculation"},{placeholder:"${C_dossier_numeroSerie}",type:"C",description:"Numéros de série"},{placeholder:"${C_dossier_motivationInvestissement}",type:"C",description:"Motivation de l'investissement"},{placeholder:"${C_dossier_justificatifInvestissement}",type:"C",description:"Justificatif de l'investissement"},{placeholder:"${C_dossier_numAssurance}",type:"C",description:"Numéro de contrat d'assurance"},{placeholder:"${I_dossier_signatureChefAgence}",type:"I",description:"Signature chef d'agence"},{placeholder:"${I_dossier_signatureDp}",type:"I",description:"Signature DP"},{placeholder:"${I_dossier_signatureGerant}",type:"I",description:"Signature du gérant"},{placeholder:"${I_dossier_signatureGerantApprouve}",type:"I",description:"Signature avec Lu et approuvé"},{placeholder:"${I_dossier_signatureGerantPromesse}",type:"I",description:"Signature promesse"},{placeholder:"${I_dossier_signatureGerantAccord}",type:"I",description:"Signature accord"},{placeholder:"${I_dossier_signatureGerantPouvoir}",type:"I",description:"Signature pouvoir"},{placeholder:"${I_dossier_signatureGerantMandat}",type:"I",description:"Signature mandat"},{placeholder:"${I_dossier_tamponSignatureGerant}",type:"I",description:"Tampon du gérant"},{placeholder:"${I_dossier_parapheGerant}",type:"I",description:"Paraphe du gérant"}]},{id:"dossierFournisseur",name:"Dossier Fournisseur",description:"Variables liées à un dossier fournisseur spécifique",variables:[{placeholder:"${C_dossierFournisseur_id}",type:"C",description:"Identifiant UUID du dossier fournisseur"},{placeholder:"${C_dossierFournisseur_territoire}",type:"C",description:"Code territoire"},{placeholder:"${C_dossierFournisseur_agence}",type:"C",description:"Code agence"},{placeholder:"${C_dossierFournisseur_descriptif}",type:"C",description:"Description des produits"},{placeholder:"${C_dossierFournisseur_dossier}",type:"C",description:"URL API du dossier parent"},{placeholder:"${C_dossierFournisseur_client}",type:"C",description:"URL API du client"},{placeholder:"${C_dossierFournisseur_commercial}",type:"C",description:"URL API du commercial"},{placeholder:"${C_dossierFournisseur_spv}",type:"C",description:"URL API de la SPV"},{placeholder:"${C_dossierFournisseur_fournisseur}",type:"C",description:"URL API du fournisseur"},{placeholder:"${C_dossierFournisseur_vendeur}",type:"C",description:"URL API du vendeur"},{placeholder:"${C_dossierFournisseur_produit}",type:"C",description:"URL API du premier produit"},{placeholder:"${C_dossierFournisseur_banque}",type:"C",description:"URL API de la banque"},{placeholder:"${C_dossierFournisseur_fournisseurId}",type:"C",description:"ID du fournisseur"},{placeholder:"${C_dossierFournisseur_fournisseurNom}",type:"C",description:"Raison sociale du fournisseur"},{placeholder:"${B_dossierFournisseur_fournisseurHasContratCadre}",type:"B",description:"Fournisseur avec contrat cadre"},{placeholder:"${C_dossierFournisseur_vendeurId}",type:"C",description:"ID du vendeur"},{placeholder:"${C_dossierFournisseur_vendeurNom}",type:"C",description:"Nom du vendeur"},{placeholder:"${C_dossierFournisseur_prixHt}",type:"C",description:"Prix HT total des produits"},{placeholder:"${C_dossierFournisseur_prixHtLettre}",type:"C",description:"Prix HT en toutes lettres"},{placeholder:"${C_dossierFournisseur_prixTtc}",type:"C",description:"Prix TTC total des produits"},{placeholder:"${C_dossierFournisseur_prixTtcLettre}",type:"C",description:"Prix TTC en toutes lettres"},{placeholder:"${C_dossierFournisseur_prixTva}",type:"C",description:"Montant TVA"},{placeholder:"${C_dossierFournisseur_fraisNonDefiscalisable}",type:"C",description:"Frais non défiscalisables"},{placeholder:"${C_dossierFournisseur_montantTvaTotalite}",type:"C",description:"TVA totalité du prêt"},{placeholder:"${C_dossierFournisseur_montantApportLocataire}",type:"C",description:"Apport du locataire"},{placeholder:"${C_dossierFournisseur_montantComplement}",type:"C",description:"Montant du complément"},{placeholder:"${C_dossierFournisseur_montantSpv}",type:"C",description:"Montant SPV"},{placeholder:"${C_dossierFournisseur_montantQuotePartBq}",type:"C",description:"Quote-part banque"},{placeholder:"${C_dossierFournisseur_montantPaiementAnticipe}",type:"C",description:"Montant du paiement anticipé"},{placeholder:"${C_dossierFournisseur_montantSubvention}",type:"C",description:"Montant de la subvention"},{placeholder:"${C_dossierFournisseur_apportLocataire}",type:"C",description:"Apport locataire (numérique)"},{placeholder:"${C_dossierFournisseur_apportLocataireLettre}",type:"C",description:"Apport locataire en toutes lettres"},{placeholder:"${C_dossierFournisseur_dateLivraison}",type:"C",description:"Date de livraison"},{placeholder:"${C_dossierFournisseur_dateLivraisonPrevisionnelle}",type:"C",description:"Date de livraison prévisionnelle"},{placeholder:"${C_dossierFournisseur_dateFacture}",type:"C",description:"Date de la facture"},{placeholder:"${C_dossierFournisseur_numFacture}",type:"C",description:"Numéro de facture"},{placeholder:"${C_dossierFournisseur_numImmatriculation}",type:"C",description:"Numéros d'immatriculation"},{placeholder:"${C_dossierFournisseur_numSerie}",type:"C",description:"Numéros de série"},{placeholder:"${C_dossierFournisseur_originComplement}",type:"C",description:"Origine du complément"},{placeholder:"${C_dossierFournisseur_ces}",type:"C",description:"Texte CES (avant ou et de)"},{placeholder:"${C_dossierFournisseur_reserveSupplementaire}",type:"C",description:"Réserve supplémentaire"},{placeholder:"${B_dossierFournisseur_isDefiscalisation}",type:"B",description:"Dossier défiscalisé"},{placeholder:"${B_dossierFournisseur_isPaiementLocataire}",type:"B",description:"Paiement par le locataire"},{placeholder:"${B_dossierFournisseur_isCreditModerne}",type:"B",description:"Financement Crédit Moderne"},{placeholder:"${B_dossierFournisseur_isMyMoneyBank}",type:"B",description:"Financement My Money Bank"},{placeholder:"${B_dossierFournisseur_hasReserve}",type:"B",description:"Documents manquants"},{placeholder:"${B_dossierFournisseur_sansReserve}",type:"B",description:"Pas de documents manquants"},{placeholder:"${B_dossierFournisseur_isLocataireFournisseur}",type:"B",description:"Locataire est fournisseur"},{placeholder:"${B_dossierFournisseur_vp}",type:"B",description:"Véhicule particulier"},{placeholder:"${B_dossierFournisseur_hasSubvention}",type:"B",description:"Subvention présente"},{placeholder:"${B_dossierFournisseur_hasReserveSupplementaire}",type:"B",description:"Réserve supplémentaire présente"},{placeholder:"${T_dossierFournisseur_listeDocLivraisonManquant}",type:"T",description:"Liste des documents manquants"}]},{id:"client",name:"Client",description:"Variables liées au client/locataire",variables:[{placeholder:"${C_client_id}",type:"C",description:"Identifiant du client"},{placeholder:"${C_client_identifiant}",type:"C",description:"Code identifiant client"},{placeholder:"${C_client_territoire}",type:"C",description:"Code territoire"},{placeholder:"${C_client_raisonSociale}",type:"C",description:"Raison sociale"},{placeholder:"${C_client_representantCivilite}",type:"C",description:"Civilité (M., Mme)"},{placeholder:"${C_client_representantNomComplet}",type:"C",description:"Nom complet du représentant"},{placeholder:"${C_client_representantNom}",type:"C",description:"Nom de famille"},{placeholder:"${C_client_representantPrenom}",type:"C",description:"Prénom"},{placeholder:"${C_client_representantFonction}",type:"C",description:"Fonction"},{placeholder:"${C_client_representantDateDeNaissance}",type:"C",description:"Date de naissance"},{placeholder:"${C_client_representantVilleDeNaissance}",type:"C",description:"Ville de naissance"},{placeholder:"${C_client_representantAdresse}",type:"C",description:"Adresse du représentant"},{placeholder:"${C_client_representantCpVille}",type:"C",description:"CP et Ville du représentant"},{placeholder:"${C_client_representantTelephone}",type:"C",description:"Téléphone du représentant"},{placeholder:"${C_client_rcs}",type:"C",description:"Ville du RCS"},{placeholder:"${C_client_immatriculation}",type:"C",description:"Numéro d'immatriculation"},{placeholder:"${C_client_typeImmatriculation}",type:"C",description:"Type (RCS, RIDET, etc.)"},{placeholder:"${C_client_numImmatriculation}",type:"C",description:"Numéro d'immatriculation"},{placeholder:"${C_client_villeImmatriculation}",type:"C",description:"Ville d'immatriculation"},{placeholder:"${C_client_numeroTahiti}",type:"C",description:"Numéro Tahiti (Polynésie)"},{placeholder:"${C_client_dateImmatriculation}",type:"C",description:"Date d'immatriculation"},{placeholder:"${C_client_dateActeDeDelegationImparfaite}",type:"C",description:"Date acte délégation"},{placeholder:"${C_client_capitalSocial}",type:"C",description:"Capital social formaté"},{placeholder:"${B_client_capitalSocialExistant}",type:"B",description:"Capital social renseigné"},{placeholder:"${B_client_capitalSocialNeant}",type:"B",description:"Capital social néant"},{placeholder:"${C_client_forme}",type:"C",description:"Forme juridique"},{placeholder:"${C_client_codeApe}",type:"C",description:"Code APE"},{placeholder:"${C_client_codeApeTexte}",type:"C",description:"Libellé du code APE"},{placeholder:"${T_client_codesApe}",type:"T",description:"Tous les codes APE"},{placeholder:"${C_client_exoTva}",type:"C",description:"Exonération TVA"},{placeholder:"${B_client_ols}",type:"B",description:"Organisme de logement social"},{placeholder:"${C_client_effectif}",type:"C",description:"Effectif de l'entreprise"},{placeholder:"${C_client_adresse}",type:"C",description:"Adresse complète"},{placeholder:"${C_client_numRue}",type:"C",description:"Numéro et rue"},{placeholder:"${C_client_codePostal}",type:"C",description:"Code postal"},{placeholder:"${C_client_ville}",type:"C",description:"Ville"},{placeholder:"${C_client_cpVille}",type:"C",description:"Code postal et ville"},{placeholder:"${C_client_bp}",type:"C",description:"Boîte postale"},{placeholder:"${C_client_pays}",type:"C",description:"Pays"},{placeholder:"${C_client_telephone}",type:"C",description:"Téléphone"},{placeholder:"${C_client_domiciliation}",type:"C",description:"Banque de domiciliation"},{placeholder:"${C_client_iban}",type:"C",description:"Numéro IBAN"},{placeholder:"${C_client_bic}",type:"C",description:"Code BIC/SWIFT"}]},{id:"commercial",name:"Commercial",description:"Variables liées au commercial en charge du dossier",variables:[{placeholder:"${C_commercial_id}",type:"C",description:"Identifiant du commercial"},{placeholder:"${C_commercial_identifiant}",type:"C",description:"Code identifiant"},{placeholder:"${C_commercial_civilite}",type:"C",description:"Civilité"},{placeholder:"${C_commercial_nom}",type:"C",description:"Nom"},{placeholder:"${C_commercial_prenom}",type:"C",description:"Prénom"},{placeholder:"${C_commercial_nomComplet}",type:"C",description:"Nom complet avec civilité"},{placeholder:"${C_commercial_email}",type:"C",description:"Email"},{placeholder:"${C_commercial_telephone}",type:"C",description:"Téléphone fixe"},{placeholder:"${C_commercial_fax}",type:"C",description:"Numéro de fax"},{placeholder:"${C_commercial_mobile}",type:"C",description:"Téléphone mobile"},{placeholder:"${C_commercial_adresse}",type:"C",description:"Adresse"},{placeholder:"${C_commercial_chefCivilite}",type:"C",description:"Civilité du chef d'agence"},{placeholder:"${C_commercial_chefNom}",type:"C",description:"Nom du chef d'agence"},{placeholder:"${C_commercial_chefPrenom}",type:"C",description:"Prénom du chef d'agence"},{placeholder:"${C_commercial_agence}",type:"C",description:"Code agence"},{placeholder:"${C_commercial_departement}",type:"C",description:"Département"},{placeholder:"${C_commercial_devise}",type:"C",description:"Devise de l'agence"},{placeholder:"${C_commercial_raisonSociale}",type:"C",description:"Raison sociale de la filiale"},{placeholder:"${C_commercial_tribunalCommerce}",type:"C",description:"Tribunal de commerce"},{placeholder:"${C_commercial_agenceAdresse}",type:"C",description:"Adresse de l'agence"},{placeholder:"${C_commercial_agenceCodePostal}",type:"C",description:"Code postal agence"},{placeholder:"${C_commercial_agenceVille}",type:"C",description:"Ville de l'agence"},{placeholder:"${C_commercial_agenceCpVille}",type:"C",description:"CP et Ville"},{placeholder:"${C_commercial_agenceAdresseComplete}",type:"C",description:"Adresse complète"},{placeholder:"${C_commercial_agenceRaisonSociale}",type:"C",description:"Raison sociale du groupe"},{placeholder:"${C_commercial_agenceCapitalSocial}",type:"C",description:"Capital social"},{placeholder:"${C_commercial_agenceCib}",type:"C",description:"Code CIB"},{placeholder:"${C_commercial_agenceTypeImmatriculation}",type:"C",description:"Type immatriculation"},{placeholder:"${C_commercial_agenceVilleImmatriculation}",type:"C",description:"Ville immatriculation"},{placeholder:"${C_commercial_agenceNumImmatriculation}",type:"C",description:"Numéro immatriculation"},{placeholder:"${C_commercial_agenceCodeApe}",type:"C",description:"Code APE"},{placeholder:"${C_commercial_agenceDepartement}",type:"C",description:"Département"},{placeholder:"${C_commercial_agenceAupres}",type:"C",description:"Texte Préfecture/DITT"},{placeholder:"${I_commercial_logo}",type:"I",description:"Logo"},{placeholder:"${I_commercial_logoAdresse}",type:"I",description:"Logo avec adresse"},{placeholder:"${I_commercial_cachetAgence}",type:"I",description:"Cachet/tampon agence"},{placeholder:"${T_commercial_territoires}",type:"T",description:"Liste des territoires"},{placeholder:"${B_commercial_isGrandCompte}",type:"B",description:"Commercial grand compte"},{placeholder:"${C_commercial_filialeMonteurId}",type:"C",description:"ID de la filiale"},{placeholder:"${C_commercial_filialeMonteurLibelle}",type:"C",description:"Libellé de la filiale"},{placeholder:"${C_commercial_groupMonteurId}",type:"C",description:"ID du groupe monteur"},{placeholder:"${C_commercial_representantQualite}",type:"C",description:"Qualité (Mandataire)"},{placeholder:"${C_commercial_gerantVille}",type:"C",description:"Ville du gérant"}]},{id:"fournisseur",name:"Fournisseur",description:"Variables liées au fournisseur",variables:[{placeholder:"${C_fournisseur_id}",type:"C",description:"Identifiant du fournisseur"},{placeholder:"${C_fournisseur_identifiant}",type:"C",description:"Code identifiant"},{placeholder:"${C_fournisseur_raisonSociale}",type:"C",description:"Raison sociale"},{placeholder:"${C_fournisseur_forme}",type:"C",description:"Forme juridique"},{placeholder:"${C_fournisseur_formeJ}",type:"C",description:"Forme juridique abrégée"},{placeholder:"${C_fournisseur_representantCivilite}",type:"C",description:"Civilité"},{placeholder:"${C_fournisseur_representantNom}",type:"C",description:"Nom"},{placeholder:"${C_fournisseur_representantPrenom}",type:"C",description:"Prénom"},{placeholder:"${C_fournisseur_representantNomComplet}",type:"C",description:"Nom complet"},{placeholder:"${C_fournisseur_representantFonction}",type:"C",description:"Fonction"},{placeholder:"${C_fournisseur_rcs}",type:"C",description:"Ville du RCS"},{placeholder:"${C_fournisseur_immatriculation}",type:"C",description:"Numéro d'immatriculation"},{placeholder:"${C_fournisseur_numImmatriculation}",type:"C",description:"Numéro d'immatriculation"},{placeholder:"${C_fournisseur_villeImmatriculation}",type:"C",description:"Ville d'immatriculation"},{placeholder:"${C_fournisseur_typeImmatriculation}",type:"C",description:"Type d'immatriculation"},{placeholder:"${C_fournisseur_numeroTahiti}",type:"C",description:"Numéro Tahiti"},{placeholder:"${C_fournisseur_dateImmatriculation}",type:"C",description:"Date d'immatriculation"},{placeholder:"${C_fournisseur_capitalSocial}",type:"C",description:"Capital social formaté"},{placeholder:"${B_fournisseur_hasContratCadreSofidom}",type:"B",description:"Contrat cadre Sofidom"},{placeholder:"${C_fournisseur_adresseComplete}",type:"C",description:"Adresse complète"},{placeholder:"${C_fournisseur_adresse}",type:"C",description:"Voie"},{placeholder:"${C_fournisseur_numRue}",type:"C",description:"Numéro et rue"},{placeholder:"${C_fournisseur_codePostal}",type:"C",description:"Code postal"},{placeholder:"${C_fournisseur_ville}",type:"C",description:"Ville"},{placeholder:"${C_fournisseur_cpVille}",type:"C",description:"Code postal et ville"},{placeholder:"${C_fournisseur_pays}",type:"C",description:"Pays"},{placeholder:"${C_fournisseur_telephone}",type:"C",description:"Téléphone"},{placeholder:"${C_fournisseur_fax}",type:"C",description:"Fax"},{placeholder:"${C_fournisseur_iban}",type:"C",description:"Numéro IBAN"},{placeholder:"${C_fournisseur_bic}",type:"C",description:"Code BIC"}]},{id:"spv",name:"Société Portage (SPV)",description:"Variables liées à la société de portage",variables:[{placeholder:"${C_spv_id}",type:"C",description:"Identifiant de la SPV"},{placeholder:"${C_spv_type}",type:"C",description:"Type de société"},{placeholder:"${C_spv_raisonSociale}",type:"C",description:"Raison sociale"},{placeholder:"${C_spv_formeJ}",type:"C",description:"Forme juridique abrégée"},{placeholder:"${C_spv_formeJLg}",type:"C",description:"Forme juridique complète"},{placeholder:"${C_spv_codeApe}",type:"C",description:"Code APE"},{placeholder:"${C_spv_devise}",type:"C",description:"Devise"},{placeholder:"${C_spv_numeroImmatriculation}",type:"C",description:"Numéro d'immatriculation"},{placeholder:"${C_spv_typeImmatriculation}",type:"C",description:"Type (RCS, etc.)"},{placeholder:"${C_spv_typeImmatriculationLettre}",type:"C",description:"Type en toutes lettres"},{placeholder:"${C_spv_villeImmatriculation}",type:"C",description:"Ville d'immatriculation"},{placeholder:"${C_spv_numAccreditation}",type:"C",description:"Numéro d'accréditation Tahiti"},{placeholder:"${C_spv_numSequentiel}",type:"C",description:"Numéro séquentiel Tahiti"},{placeholder:"${C_spv_capitalSocial}",type:"C",description:"Capital social formaté"},{placeholder:"${C_spv_cib}",type:"C",description:"Code CIB"},{placeholder:"${C_spv_adresseComplete}",type:"C",description:"Adresse complète"},{placeholder:"${C_spv_adresse}",type:"C",description:"Voie"},{placeholder:"${C_spv_codePostal}",type:"C",description:"Code postal"},{placeholder:"${C_spv_ville}",type:"C",description:"Ville"},{placeholder:"${C_spv_codePostalVille}",type:"C",description:"Code postal et ville"},{placeholder:"${C_spv_pays}",type:"C",description:"Pays"},{placeholder:"${C_spv_telephone}",type:"C",description:"Téléphone"},{placeholder:"${C_spv_representantCivilite}",type:"C",description:"Civilité"},{placeholder:"${C_spv_representantNom}",type:"C",description:"Nom"},{placeholder:"${C_spv_representantPrenom}",type:"C",description:"Prénom"},{placeholder:"${C_spv_representantNomComplet}",type:"C",description:"Nom complet"},{placeholder:"${C_spv_representantFonction}",type:"C",description:"Fonction"},{placeholder:"${C_spv_gerantNomComplet}",type:"C",description:"Nom complet du gérant personne physique"},{placeholder:"${C_spv_gerantFonction}",type:"C",description:"Fonction (Directeur Général)"},{placeholder:"${C_spv_gerantFormeJ}",type:"C",description:"Forme juridique du gérant (SA)"},{placeholder:"${C_spv_gerantRaisonSociale}",type:"C",description:"Raison sociale (INTER INVEST)"},{placeholder:"${C_spv_gerantAdresse}",type:"C",description:"Adresse"},{placeholder:"${C_spv_gerantCP}",type:"C",description:"Code postal"},{placeholder:"${C_spv_gerantVille}",type:"C",description:"Ville"},{placeholder:"${C_spv_gerantVilleImmat}",type:"C",description:"Ville d'immatriculation"},{placeholder:"${C_spv_gerantNumeroImmat}",type:"C",description:"Numéro d'immatriculation"},{placeholder:"${C_spv_gerantCodeApe}",type:"C",description:"Code APE"},{placeholder:"${C_spv_associeSecondaireRaisonSociale}",type:"C",description:"Raison sociale de l'associé secondaire"},{placeholder:"${B_spv_isJPO}",type:"B",description:"SPV JP Ocean"},{placeholder:"${I_spv_cachet}",type:"I",description:"Tampon de la SPV"}]},{id:"produit",name:"Produit",description:"Variables liées aux produits financés",variables:[{placeholder:"${C_produit_id}",type:"C",description:"Identifiant UUID du produit"},{placeholder:"${C_produit_territoire}",type:"C",description:"Code territoire"},{placeholder:"${C_produit_agence}",type:"C",description:"Code agence"},{placeholder:"${C_produit_devise}",type:"C",description:"Devise"},{placeholder:"${C_produit_dossier}",type:"C",description:"URL API du dossier"},{placeholder:"${C_produit_dossierFournisseur}",type:"C",description:"URL API dossier fournisseur"},{placeholder:"${C_produit_client}",type:"C",description:"URL API du client"},{placeholder:"${C_produit_spv}",type:"C",description:"URL API de la SPV"},{placeholder:"${C_produit_commercial}",type:"C",description:"URL API du commercial"},{placeholder:"${C_produit_fournisseur}",type:"C",description:"URL API du fournisseur"},{placeholder:"${C_produit_produitAssurance}",type:"C",description:"URL API de l'assurance"},{placeholder:"${C_produit_destinataire}",type:"C",description:"Destinataire (fournisseur ou client)"},{placeholder:"${C_produit_marque}",type:"C",description:"Marque"},{placeholder:"${C_produit_modele}",type:"C",description:"Modèle"},{placeholder:"${C_produit_type}",type:"C",description:"Type/Options"},{placeholder:"${C_produit_segment}",type:"C",description:"Segment parent"},{placeholder:"${C_produit_typeProduit}",type:"C",description:"Type pour assurance"},{placeholder:"${C_produit_prixTtcLocal}",type:"C",description:"Prix TTC en devise locale"},{placeholder:"${C_produit_prixHt}",type:"C",description:"Prix HT"},{placeholder:"${C_produit_montantProduitHT}",type:"C",description:"Montant HT du produit"},{placeholder:"${C_produit_numImmatriculation}",type:"C",description:"Numéro d'immatriculation"},{placeholder:"${C_produit_numSerie}",type:"C",description:"Numéro de série"},{placeholder:"${C_produit_typeCarteGrise}",type:"C",description:"Type de carte grise"},{placeholder:"${C_produit_puissanceFiscale}",type:"C",description:"Puissance fiscale"},{placeholder:"${C_produit_dateMiseEnCirculation}",type:"C",description:"Date de mise en circulation"},{placeholder:"${C_produit_ptac}",type:"C",description:"PTAC"},{placeholder:"${C_produit_ptacLibelle}",type:"C",description:"Libellé du PTAC"},{placeholder:"${C_produit_prefectureImmatriculation}",type:"C",description:"Préfecture d'immatriculation"},{placeholder:"${C_produit_dateDeLivraison}",type:"C",description:"Date de livraison"},{placeholder:"${C_produit_immoAdresse}",type:"C",description:"Adresse du bien (immobilier)"},{placeholder:"${C_produit_immoCadastre}",type:"C",description:"Référence cadastrale"},{placeholder:"${C_produit_immoLoyer}",type:"C",description:"Loyer du bail"},{placeholder:"${C_produit_immoVille}",type:"C",description:"Ville"},{placeholder:"${C_produit_immoCp}",type:"C",description:"Code postal"},{placeholder:"${C_produit_immoCedantRaisonSocial}",type:"C",description:"Raison sociale du cédant"},{placeholder:"${C_produit_immoCedantVille}",type:"C",description:"Ville du cédant"},{placeholder:"${C_produit_immoCedantCp}",type:"C",description:"Code postal du cédant"},{placeholder:"${C_produit_immoAnneFinBail}",type:"C",description:"Année de fin de bail"},{placeholder:"${B_produit_isDefiscalisation}",type:"B",description:"Produit défiscalisé"},{placeholder:"${B_produit_isLOA}",type:"B",description:"Location avec Option d'Achat"},{placeholder:"${B_produit_hasTVA}",type:"B",description:"TVA applicable"},{placeholder:"${C_produit_ces}",type:"C",description:"Texte CES (avant ou et de)"},{placeholder:"${B_produit_hasImmat}",type:"B",description:"Immatriculation présente"},{placeholder:"${B_produit_hasSerie}",type:"B",description:"Numéro de série présent"}]},{id:"produitAssurance",name:"Produit Assurance",description:"Variables liées à l'assurance d'un produit",variables:[{placeholder:"${C_produitAssurance_id}",type:"C",description:"Identifiant UUID"},{placeholder:"${C_produitAssurance_agence}",type:"C",description:"Code agence"},{placeholder:"${C_produitAssurance_devise}",type:"C",description:"Devise"},{placeholder:"${C_produitAssurance_produit}",type:"C",description:"URL API du produit"},{placeholder:"${C_produitAssurance_dossier}",type:"C",description:"URL API du dossier"},{placeholder:"${C_produitAssurance_dossierFournisseur}",type:"C",description:"URL API dossier fournisseur"},{placeholder:"${C_produitAssurance_client}",type:"C",description:"URL API du client"},{placeholder:"${C_produitAssurance_commercial}",type:"C",description:"URL API du commercial"},{placeholder:"${C_produitAssurance_spv}",type:"C",description:"URL API de la SPV"},{placeholder:"${C_produitAssurance_raisonSociale}",type:"C",description:"Raison sociale de l'assureur"},{placeholder:"${C_produitAssurance_email}",type:"C",description:"Email de l'assureur"},{placeholder:"${C_produitAssurance_typeProduit}",type:"C",description:"Type de produit assuré"},{placeholder:"${C_produitAssurance_garantie}",type:"C",description:"Garantie du produit"},{placeholder:"${C_produitAssurance_datePriseEffet}",type:"C",description:"Date de prise d'effet"},{placeholder:"${C_produitAssurance_anneePriseEffet}",type:"C",description:"Année de prise d'effet"},{placeholder:"${C_produitAssurance_dateEcheance}",type:"C",description:"Date d'échéance"},{placeholder:"${C_produitAssurance_echeancePrincipale}",type:"C",description:"Échéance principale"},{placeholder:"${C_produitAssurance_frequence}",type:"C",description:"Fréquence de paiement"},{placeholder:"${C_produitAssurance_montantAnnuel}",type:"C",description:"Prime annuelle totale"},{placeholder:"${C_produitAssurance_montantMensuel}",type:"C",description:"Prime mensuelle totale"},{placeholder:"${C_produitAssurance_montantAnnuelRc}",type:"C",description:"Prime RC annuelle"},{placeholder:"${C_produitAssurance_montantMensuelRc}",type:"C",description:"Prime RC mensuelle"},{placeholder:"${C_produitAssurance_montantAnnuelDomm}",type:"C",description:"Prime Dommages annuelle"},{placeholder:"${C_produitAssurance_montantMensuelDomm}",type:"C",description:"Prime Dommages mensuelle"}]},{id:"caution",name:"Caution",description:"Variables liées aux cautions",variables:[{placeholder:"${C_caution_id}",type:"C",description:"Identifiant de la caution"},{placeholder:"${B_caution_cautionPersonnelle}",type:"B",description:"Caution personnelle"},{placeholder:"${B_caution_personneMorale}",type:"B",description:"Caution personne morale"},{placeholder:"${C_caution_dossier}",type:"C",description:"URL API du dossier"},{placeholder:"${C_caution_client}",type:"C",description:"URL API du client"},{placeholder:"${C_caution_representantCivilite}",type:"C",description:"Civilité"},{placeholder:"${C_caution_representantMasculin}",type:"C",description:"Genre (Oui ou Non)"},{placeholder:"${C_caution_representantNom}",type:"C",description:"Nom"},{placeholder:"${C_caution_representantPrenom}",type:"C",description:"Prénom"},{placeholder:"${C_caution_representantFonction}",type:"C",description:"Fonction"},{placeholder:"${C_caution_representantDateDeNaissance}",type:"C",description:"Date de naissance"},{placeholder:"${C_caution_representantVilleDeNaissance}",type:"C",description:"Ville de naissance"},{placeholder:"${C_caution_raisonSociale}",type:"C",description:"Raison sociale"},{placeholder:"${C_caution_forme}",type:"C",description:"Forme juridique"},{placeholder:"${C_caution_capitalSocial}",type:"C",description:"Capital social"},{placeholder:"${C_caution_rcs}",type:"C",description:"RCS"},{placeholder:"${C_caution_immatriculation}",type:"C",description:"Date d'immatriculation"},{placeholder:"${C_caution_numImmatriculation}",type:"C",description:"Numéro d'immatriculation"},{placeholder:"${C_caution_villeImmatriculation}",type:"C",description:"Ville d'immatriculation"},{placeholder:"${C_caution_numeroTahiti}",type:"C",description:"Numéro Tahiti"},{placeholder:"${C_caution_adresse}",type:"C",description:"Adresse"},{placeholder:"${C_caution_numRue}",type:"C",description:"Numéro et rue"},{placeholder:"${C_caution_codePostal}",type:"C",description:"Code postal"},{placeholder:"${C_caution_cpVille}",type:"C",description:"Code postal"},{placeholder:"${C_caution_ville}",type:"C",description:"Ville"},{placeholder:"${C_caution_devise}",type:"C",description:"Devise"},{placeholder:"${C_caution_deviseLettre}",type:"C",description:"Devise en lettres"},{placeholder:"${C_caution_financement}",type:"C",description:"Montant du financement"},{placeholder:"${C_caution_financementLettre}",type:"C",description:"Financement en lettres"},{placeholder:"${C_caution_sommeMaximale}",type:"C",description:"Somme maximale cautionnée"},{placeholder:"${C_caution_sommeMaximaleLettre}",type:"C",description:"Somme maximale en lettres"}]},{id:"mandatCaution",name:"Mandat Caution",description:"Variables liées aux mandats de caution (legacy)",variables:[{placeholder:"${C_mandatCaution_id}",type:"C",description:"Identifiant du mandat"},{placeholder:"${C_mandatCaution_territoire}",type:"C",description:"Code territoire"},{placeholder:"${C_mandatCaution_agence}",type:"C",description:"Code agence"},{placeholder:"${C_mandatCaution_dossier}",type:"C",description:"URL API du dossier"},{placeholder:"${C_mandatCaution_client}",type:"C",description:"URL API du client"},{placeholder:"${B_mandatCaution_cautionPersonnelle}",type:"B",description:"Caution personnelle"},{placeholder:"${B_mandatCaution_personneMorale}",type:"B",description:"Personne morale"}]},{id:"creditFournisseur",name:"Crédit Fournisseur",description:"Variables liées aux crédits fournisseur",variables:[{placeholder:"${C_creditFournisseur_id}",type:"C",description:"Identifiant UUID"},{placeholder:"${C_creditFournisseur_dossier}",type:"C",description:"URL API du dossier"},{placeholder:"${C_creditFournisseur_fournisseur}",type:"C",description:"URL API du fournisseur"},{placeholder:"${C_creditFournisseur_dossierFournisseur}",type:"C",description:"URL API dossier fournisseur"},{placeholder:"${C_creditFournisseur_client}",type:"C",description:"URL API du client"},{placeholder:"${C_creditFournisseur_descriptif}",type:"C",description:"Description"},{placeholder:"${C_creditFournisseur_dateDebut}",type:"C",description:"Date de début (format Y-m-d)"},{placeholder:"${C_creditFournisseur_nombreMois}",type:"C",description:"Nombre de mois"},{placeholder:"${C_creditFournisseur_montant}",type:"C",description:"Montant"},{placeholder:"${C_creditFournisseur_montantLocal}",type:"C",description:"Montant en devise locale"},{placeholder:"${C_creditFournisseur_echeance}",type:"C",description:"Montant de l'échéance"}]},{id:"attestation",name:"Attestation Prix Net",description:"Variables pour les attestations de prix net fournisseur",variables:[{placeholder:"${C_attestation_id}",type:"C",description:"Identifiant"},{placeholder:"${C_attestation_raisonSociale}",type:"C",description:"Raison sociale"},{placeholder:"${C_attestation_adresse}",type:"C",description:"Adresse"},{placeholder:"${C_attestation_codePostal}",type:"C",description:"Code postal"},{placeholder:"${C_attestation_ville}",type:"C",description:"Ville"},{placeholder:"${C_attestation_dossier}",type:"C",description:"URL API du dossier"},{placeholder:"${C_attestation_dossierFournisseur}",type:"C",description:"URL API dossier fournisseur"},{placeholder:"${C_attestation_client}",type:"C",description:"URL API du client"},{placeholder:"${C_attestation_spv}",type:"C",description:"URL API de la SPV"},{placeholder:"${C_attestation_commercial}",type:"C",description:"URL API du commercial"},{placeholder:"${C_attestation_fournisseur}",type:"C",description:"URL API du fournisseur"},{placeholder:"${T_attestation_facture}",type:"T",description:"Liste des factures"},{placeholder:"${B_attestation_factureDetaille}",type:"B",description:"Facture détaillée"},{placeholder:"${B_attestation_notFactureDetaille}",type:"B",description:"Facture non détaillée"}]},{id:"societe",name:"Société (Assurance)",description:"Variables pour les compagnies d'assurance",variables:[{placeholder:"${C_societe_id}",type:"C",description:"Identifiant"},{placeholder:"${C_societe_nom}",type:"C",description:"Nom de la société"},{placeholder:"${C_societe_adresse}",type:"C",description:"Adresse"},{placeholder:"${C_societe_cp}",type:"C",description:"Code postal"},{placeholder:"${C_societe_ville}",type:"C",description:"Ville"},{placeholder:"${C_societe_email}",type:"C",description:"Email"}]},{id:"simulation",name:"Simulation",description:"Variables pour les simulations de financement",variables:[{placeholder:"${C_simulation_id}",type:"C",description:"Identifiant UUID"},{placeholder:"${C_simulation_dateDuJour}",type:"C",description:"Date du jour"},{placeholder:"${C_simulation_mailSent}",type:"C",description:"Date d'envoi par email"},{placeholder:"${C_simulation_clientRaisonSociale}",type:"C",description:"Raison sociale du client"},{placeholder:"${C_simulation_clientNomComplet}",type:"C",description:"Nom complet du contact"},{placeholder:"${C_simulation_clientTelephone}",type:"C",description:"Téléphone"},{placeholder:"${C_simulation_clientMail}",type:"C",description:"Email(s)"},{placeholder:"${C_simulation_fournisseurRaisonSociale}",type:"C",description:"Raison sociale du fournisseur"},{placeholder:"${C_simulation_fournisseurVendeur}",type:"C",description:"Nom du vendeur"},{placeholder:"${C_simulation_commercialNomComplet}",type:"C",description:"Nom complet"},{placeholder:"${C_simulation_commercialTel}",type:"C",description:"Téléphone"},{placeholder:"${C_simulation_agenceVille}",type:"C",description:"Ville de l'agence"},{placeholder:"${C_simulation_entreprise}",type:"C",description:"Nom de l'entreprise (2IOM ou JPO)"},{placeholder:"${C_simulation_filiale}",type:"C",description:"Nom de la filiale"},{placeholder:"${C_simulation_produit}",type:"C",description:"Description du produit"},{placeholder:"${C_simulation_type}",type:"C",description:"Type de financement"},{placeholder:"${C_simulation_financementType}",type:"C",description:"Description du type de financement"},{placeholder:"${C_simulation_financementTypeValue}",type:"C",description:"Valeur du type (enum)"},{placeholder:"${C_simulation_titreType}",type:"C",description:"Titre (Financement ou Complément)"},{placeholder:"${C_simulation_devise}",type:"C",description:"Devise"},{placeholder:"${C_simulation_mailRgpd}",type:"C",description:"Email RGPD"},{placeholder:"${C_simulation_titreA}",type:"C",description:"Titre A"},{placeholder:"${C_simulation_valeurA}",type:"C",description:"Investissement TTC"},{placeholder:"${C_simulation_titreB}",type:"C",description:"Titre B"},{placeholder:"${C_simulation_valeurB}",type:"C",description:"Frais non-défiscalisables"},{placeholder:"${C_simulation_titreC}",type:"C",description:"Titre C"},{placeholder:"${C_simulation_valeurC}",type:"C",description:"TVA sur investissement"},{placeholder:"${C_simulation_titreD}",type:"C",description:"Titre D"},{placeholder:"${C_simulation_valeurD}",type:"C",description:"Base défiscalisable"},{placeholder:"${C_simulation_titreE}",type:"C",description:"Titre E"},{placeholder:"${C_simulation_valeurE}",type:"C",description:"Rétrocession / Apport SPV"},{placeholder:"${C_simulation_titreF}",type:"C",description:"Titre F"},{placeholder:"${C_simulation_valeurF}",type:"C",description:"Apport locataire"},{placeholder:"${C_simulation_titreG}",type:"C",description:"Titre G"},{placeholder:"${C_simulation_valeurG}",type:"C",description:"Durée de la location (mois)"},{placeholder:"${C_simulation_titreH}",type:"C",description:"Titre H"},{placeholder:"${C_simulation_valeurH}",type:"C",description:"Montant du prêt"},{placeholder:"${C_simulation_titreI}",type:"C",description:"Titre I"},{placeholder:"${C_simulation_valeurI}",type:"C",description:"Premiers loyers"},{placeholder:"${C_simulation_titreJ}",type:"C",description:"Titre J"},{placeholder:"${C_simulation_valeurJ}",type:"C",description:"Premiers loyers TTC"},{placeholder:"${C_simulation_titreK}",type:"C",description:"Titre K"},{placeholder:"${C_simulation_valeurK}",type:"C",description:"Derniers loyers"},{placeholder:"${C_simulation_titreL}",type:"C",description:"Titre L"},{placeholder:"${C_simulation_valeurL}",type:"C",description:"Derniers loyers TTC"},{placeholder:"${C_simulation_titreM}",type:"C",description:"Titre M"},{placeholder:"${C_simulation_valeurM}",type:"C",description:"Aides publiques"},{placeholder:"${C_simulation_assurance}",type:"C",description:"Information assurance"},{placeholder:"${C_simulation_tva}",type:"C",description:"Information TVA"},{placeholder:"${B_simulation_fraisDossier}",type:"B",description:"Frais de dossier"},{placeholder:"${B_simulation_noFraisDossier}",type:"B",description:"Pas de frais de dossier"},{placeholder:"${C_simulation_montantFraisDossier}",type:"C",description:"Montant des frais"},{placeholder:"${B_simulation_aidesPubliques}",type:"B",description:"Aides publiques"},{placeholder:"${B_simulation_isLineaire}",type:"B",description:"Remboursement linéaire"},{placeholder:"${B_simulation_isSofidom}",type:"B",description:"Financement Sofidom"},{placeholder:"${I_simulation_logo}",type:"I",description:"Logo"},{placeholder:"${C_simulation_footer1}",type:"C",description:"Ligne 1 du footer"},{placeholder:"${C_simulation_footer2}",type:"C",description:"Ligne 2 du footer"},{placeholder:"${C_simulation_footer3}",type:"C",description:"Ligne 3 du footer"}]}];function $(){const e=[];return y.forEach(i=>{i.variables.forEach(r=>{e.push({...r,categoryId:i.id,categoryName:i.name})})}),e}const f="tdprint_favorites";let v=[],g="";function b(){!function(){try{const e=localStorage.getItem(f);v=e?JSON.parse(e):[]}catch(e){console.error("Erreur de chargement des favoris:",e),v=[]}}(),function(){const e=document.getElementById("categoriesContainer");e.innerHTML=y.map(e=>`\n      <div class="category" data-category-id="${e.id}">\n        <div class="category-header" onclick="toggleCategory('${e.id}')">\n          <div class="category-header-left">\n            <span class="category-icon">\n              <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">\n                <path d="M6 4l4 4-4 4V4z"/>\n              </svg>\n            </span>\n            <span class="category-name">${e.name}</span>\n          </div>\n          <span class="badge-count">${e.variables.length}</span>\n        </div>\n        <div class="category-content">\n          <div class="variables-list">\n            ${e.variables.map(i=>I({...i,categoryName:e.name})).join("")}\n          </div>\n        </div>\n      </div>\n    `).join(""),y.forEach(i=>{T(e.querySelector(`[data-category-id="${i.id}"]`).querySelector(".variables-list"))})}(),A(),function(){const e=document.getElementById("searchInput"),i=document.getElementById("clearSearch");e.addEventListener("input",e=>{g=e.target.value.trim(),i.classList.toggle("visible",g.length>0),P()}),i.addEventListener("click",()=>{e.value="",g="",i.classList.remove("visible"),P()}),document.addEventListener("keydown",r=>{"Escape"===r.key&&g&&(e.value="",g="",i.classList.remove("visible"),P()),(r.ctrlKey||r.metaKey)&&"f"===r.key&&(r.preventDefault(),e.focus())})}()}function x(e){return v.includes(e)}function A(){const e=document.getElementById("favoritesSection"),i=document.getElementById("favoritesContainer"),r=document.getElementById("favoritesCount");if(0===v.length)return void e.classList.add("hidden");e.classList.remove("hidden"),r.textContent=v.length;const o=$(),t=v.map(e=>o.find(i=>i.placeholder===e)).filter(Boolean);i.innerHTML=t.map(e=>I(e,!0)).join(""),T(i)}function I(e,i=!1){const r=x(e.placeholder),o=`type-${e.type}`,t={C:"Champ",B:"Booléen",I:"Image",T:"Tableau"}[n=e.type]||n;var n;return`\n    <div class="variable-item"\n         draggable="true"\n         data-placeholder="${e.placeholder}"\n         data-type="${e.type}">\n      <div class="variable-main">\n        <div class="variable-header">\n          <span class="variable-placeholder">${B(e.placeholder,g)}</span>\n          <span class="variable-type ${o}" title="${t}">${e.type}</span>\n        </div>\n        <div class="variable-description">${B(e.description,g)}</div>\n        ${i&&e.categoryName?`<div class="variable-category">${B(e.categoryName,g)}</div>`:""}\n      </div>\n      <button class="favorite-btn ${r?"active":""}"\n              data-placeholder="${e.placeholder}"\n              title="${r?"Retirer des favoris":"Ajouter aux favoris"}">\n        <svg viewBox="0 0 16 16" fill="currentColor">\n          ${r?'<path d="M8 1.5l1.854 3.758 4.146.603-3 2.923.708 4.13L8 11.062l-3.708 1.852.708-4.13-3-2.923 4.146-.603L8 1.5z"/>':'<path d="M8 1.5l1.854 3.758 4.146.603-3 2.923.708 4.13L8 11.062l-3.708 1.852.708-4.13-3-2.923 4.146-.603L8 1.5zm0 2.445L6.764 6.36l-2.682.39 1.941 1.891-.458 2.67L8 9.857l2.435 1.28-.458-2.67 1.941-1.891-2.682-.39L8 3.945z"/>'}\n        </svg>\n      </button>\n      <button class="insert-btn" data-placeholder="${e.placeholder}" title="Insérer">\n        Insérer\n      </button>\n    </div>\n  `}function T(e){e.querySelectorAll(".variable-item").forEach(e=>{e.addEventListener("dragstart",L),e.addEventListener("dragend",F)}),e.querySelectorAll(".favorite-btn").forEach(e=>{e.addEventListener("click",i=>{i.stopPropagation(),function(e){const i=v.indexOf(e);-1===i?(v.push(e),D("Ajouté aux favoris","success")):(v.splice(i,1),D("Retiré des favoris")),function(){try{localStorage.setItem(f,JSON.stringify(v))}catch(e){console.error("Erreur de sauvegarde des favoris:",e)}}(),A(),document.querySelectorAll(".favorite-btn").forEach(e=>{const i=e.dataset.placeholder;e.classList.toggle("active",x(i))})}(e.dataset.placeholder)})}),e.querySelectorAll(".insert-btn").forEach(e=>{e.addEventListener("click",i=>{i.stopPropagation(),async function(e){if("undefined"!=typeof Word&&Word.run)try{await Word.run(async i=>{i.document.getSelection().insertText(e,Word.InsertLocation.replace),await i.sync()}),D(`Variable insérée: ${e}`,"success")}catch(e){console.error("Erreur d'insertion:",e),D("Erreur lors de l'insertion","error")}else try{await navigator.clipboard.writeText(e),D(`Copié: ${e}`,"success")}catch(i){D(`Variable: ${e}`,"success")}}(e.dataset.placeholder)})})}function P(){const e=document.getElementById("noResults"),i=g.toLowerCase();let r=!1;y.forEach(e=>{const o=document.querySelector(`[data-category-id="${e.id}"]`),t=o.querySelector(".variables-list");let n=!1;e.variables.forEach(o=>{const a=t.querySelector(`[data-placeholder="${o.placeholder}"]`);if(!a)return;const s=!i||o.placeholder.toLowerCase().includes(i)||o.description.toLowerCase().includes(i)||e.name.toLowerCase().includes(i);a.style.display=s?"":"none",s&&(n=!0,r=!0)}),o.style.display=n?"":"none",i&&n&&o.classList.add("expanded"),i&&(t.innerHTML=e.variables.map(i=>I({...i,categoryName:e.name})).join(""),T(t),e.variables.forEach(r=>{const o=t.querySelector(`[data-placeholder="${r.placeholder}"]`);if(!o)return;const n=r.placeholder.toLowerCase().includes(i)||r.description.toLowerCase().includes(i)||e.name.toLowerCase().includes(i);o.style.display=n?"":"none"}))}),A(),i&&document.getElementById("favoritesContainer").querySelectorAll(".variable-item").forEach(e=>{const o=e.dataset.placeholder,t=$().find(e=>e.placeholder===o);if(!t)return;const n=t.placeholder.toLowerCase().includes(i)||t.description.toLowerCase().includes(i)||t.categoryName&&t.categoryName.toLowerCase().includes(i);e.style.display=n?"":"none",n&&(r=!0)}),e.classList.toggle("hidden",r||!i)}function B(e,i){if(!i)return e;const r=new RegExp(`(${o=i,o.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"gi");var o;return e.replace(r,'<span class="highlight">$1</span>')}function L(e){const i=e.target.dataset.placeholder||e.target.closest(".variable-item").dataset.placeholder;e.dataTransfer.setData("text/plain",i),e.dataTransfer.effectAllowed="copy",e.target.classList.add("dragging")}function F(e){e.target.classList.remove("dragging")}function D(e,i=""){const r=document.querySelector(".toast");r&&r.remove();const o=document.createElement("div");o.className=`toast ${i}`,o.textContent=e,document.body.appendChild(o),requestAnimationFrame(()=>{o.classList.add("show")}),setTimeout(()=>{o.classList.remove("show"),setTimeout(()=>o.remove(),300)},2e3)}Office.onReady(e=>{b()}),"undefined"==typeof Office&&document.addEventListener("DOMContentLoaded",b),window.toggleCategory=function(e){const i=document.querySelector(`[data-category-id="${e}"]`);i&&i.classList.toggle("expanded")}})();